function [ ELx, ELy, ELz ] = EL_terms(matrix, K11, K22, K33, deltax, deltay, deltaz)
%%currently running the
%         if nargin < 7
%             deltax = 1;
%             deltay = 1;
%             deltaz = 1;
%         else if nargin < 4
%             K11 = 1;
%             K22 = 1;
%             K33 = 1;
%         end


Nx = matrix(:,:,:,1);
Ny = matrix(:,:,:,2);
Nz = matrix(:,:,:,3);

[dNxdx, dNxdy, dNxdz] = gradient(Nx, deltax, deltay, deltaz);
[d2Nxdxdx, d2Nxdxdy, d2Nxdxdz] = gradient(dNxdx,deltax,deltay,deltaz);
[~, d2Nxdydy, d2Nxdydz] = gradient(dNxdy,deltax,deltay,deltaz); % 1 repeat
[~, ~, d2Nxdzdz] = gradient(dNxdz,deltax,deltay,deltaz); % 2 repeats

[dNydx, dNydy, dNydz] = gradient(Ny, deltax, deltay, deltaz);
[d2Nydxdx, d2Nydxdy, d2Nydxdz] = gradient(dNydx,deltax,deltay,deltaz);
[~, d2Nydydy, d2Nydydz] = gradient(dNydy,deltax,deltay,deltaz); % 1 repeat
[~, ~, d2Nydzdz] = gradient(dNydz,deltax,deltay,deltaz); % 2 repeats

[dNzdx, dNzdy, dNzdz] = gradient(Nz, deltax, deltay, deltaz);
[d2Nzdxdx, d2Nzdxdy, d2Nzdxdz] = gradient(dNzdx,deltax,deltay,deltaz);
[~, d2Nzdydy, d2Nzdydz] = gradient(dNzdy,deltax,deltay,deltaz); % 1 repeat
[~, ~, d2Nzdzdz] = gradient(dNzdz,deltax,deltay,deltaz); % 2 repeats

%% Oseen Frank (I think)

%{
ELx = K22.*(2.*dNxdx.^2.*Nx+(-2).*dNxdy.^2.*Nx+(-2).*dNxdz.^2.*Nx+2.* ...
  dNxdz.*dNzdx.*Nx+2.*d2Nxdxdx.*Nx.^2+(-2).*d2Nxdydy.*Nx.^2+(-2).* ...
  d2Nxdzdz.*Nx.^2+2.*d2Nydxdy.*Nx.^2+2.*d2Nzdxdz.*Nx.^2+2.*dNydx.* ...
  dNydy.*Ny+(-2).*dNxdz.*dNydz.*Ny+dNydz.*dNzdx.*Ny+dNxdz.*dNzdy.* ...
  Ny+dNydx.*dNzdz.*Ny+4.*d2Nxdxdy.*Nx.*Ny+(-1).*d2Nydzdz.*Nx.*Ny+ ...
  d2Nzdydz.*Nx.*Ny+(-1).*d2Nxdzdz.*Ny.^2+2.*d2Nydxdy.*Ny.^2+ ...
  d2Nzdxdz.*Ny.^2+dNxdz.*dNydy.*Nz+dNydy.*dNzdx.*Nz+dNydx.*dNzdy.* ...
  Nz+2.*dNzdx.*dNzdz.*Nz+4.*d2Nxdxdz.*Nx.*Nz+d2Nydydz.*Nx.*Nz+(-1).* ...
  d2Nzdydy.*Nx.*Nz+2.*d2Nxdydz.*Ny.*Nz+d2Nydxdz.*Ny.*Nz+d2Nzdxdy.* ...
  Ny.*Nz+(-1).*d2Nxdydy.*Nz.^2+d2Nydxdy.*Nz.^2+2.*d2Nzdxdz.*Nz.^2+ ...
  2.*dNxdx.*(dNydy.*Nx+dNzdz.*Nx+dNxdy.*Ny+dNxdz.*Nz)+dNxdy.*(2.* ...
  dNydx.*Nx+dNzdz.*Ny+dNydz.*Nz+(-2).*dNzdy.*Nz))+K11.*((-2).* ...
  dNxdz.*dNzdx.*Nx+(-4).*d2Nxdxdx.*Nx.^2+(-2).*d2Nydxdy.*Nx.^2+(-2) ...
  .*d2Nzdxdz.*Nx.^2+(-1).*dNydx.^2.*Nx.^3+2.*dNxdz.*dNzdx.*Nx.^3+( ...
  -1).*dNzdx.^2.*Nx.^3+2.*d2Nxdxdx.*Nx.^4+(-2).*dNydx.*dNydy.*Ny+( ...
  -1).*dNydz.*dNzdx.*Ny+(-1).*dNxdz.*dNzdy.*Ny+(-1).*dNydx.*dNzdz.* ...
  Ny+(-4).*d2Nxdxdy.*Nx.*Ny+(-1).*d2Nydxdx.*Nx.*Ny+(-1).*d2Nydydy.* ...
  Nx.*Ny+(-1).*d2Nzdydz.*Nx.*Ny+dNydx.*dNydy.*Nx.^2.*Ny+dNydz.* ...
  dNzdx.*Nx.^2.*Ny+2.*dNxdz.*dNzdy.*Nx.^2.*Ny+(-1).*dNzdx.*dNzdy.* ...
  Nx.^2.*Ny+dNydx.*dNzdz.*Nx.^2.*Ny+4.*d2Nxdxdy.*Nx.^3.*Ny+ ...
  d2Nydxdx.*Nx.^3.*Ny+(-1).*d2Nxdxdx.*Ny.^2+(-1).*d2Nxdydy.*Ny.^2+( ...
  -2).*d2Nydxdy.*Ny.^2+(-1).*d2Nzdxdz.*Ny.^2+2.*dNxdy.^2.*Nx.*Ny.^2+ ...
  (-2).*dNydx.^2.*Nx.*Ny.^2+2.*dNydy.^2.*Nx.*Ny.^2+dNxdz.*dNzdx.* ...
  Nx.*Ny.^2+(-1).*dNzdx.^2.*Nx.*Ny.^2+dNydz.*dNzdy.*Nx.*Ny.^2+ ...
  dNydy.*dNzdz.*Nx.*Ny.^2+d2Nxdxdx.*Nx.^2.*Ny.^2+2.*d2Nxdydy.* ...
  Nx.^2.*Ny.^2+2.*d2Nydxdy.*Nx.^2.*Ny.^2+(-2).*dNydx.*dNydy.*Ny.^3+ ...
  dNxdz.*dNzdy.*Ny.^3+(-1).*dNzdx.*dNzdy.*Ny.^3+2.*d2Nxdxdy.*Nx.* ...
  Ny.^3+d2Nydydy.*Nx.*Ny.^3+d2Nxdydy.*Ny.^4+(-1).*dNxdz.*dNydy.*Nz+( ...
  -1).*dNydy.*dNzdx.*Nz+(-1).*dNydx.*dNzdy.*Nz+(-2).*dNxdz.*dNzdz.* ...
  Nz+(-2).*dNzdx.*dNzdz.*Nz+(-4).*d2Nxdxdz.*Nx.*Nz+(-1).*d2Nydydz.* ...
  Nx.*Nz+(-1).*d2Nzdxdx.*Nx.*Nz+(-1).*d2Nzdzdz.*Nx.*Nz+2.*dNxdz.* ...
  dNydy.*Nx.^2.*Nz+(-1).*dNydx.*dNydz.*Nx.^2.*Nz+dNydy.*dNzdx.* ...
  Nx.^2.*Nz+dNydx.*dNzdy.*Nx.^2.*Nz+4.*dNxdz.*dNzdz.*Nx.^2.*Nz+ ...
  dNzdx.*dNzdz.*Nx.^2.*Nz+4.*d2Nxdxdz.*Nx.^3.*Nz+d2Nzdxdx.*Nx.^3.* ...
  Nz+(-2).*d2Nxdydz.*Ny.*Nz+(-1).*d2Nydxdz.*Ny.*Nz+(-1).*d2Nzdxdy.* ...
  Ny.*Nz+2.*dNxdz.*dNydx.*Nx.*Ny.*Nz+2.*dNydy.*dNydz.*Nx.*Ny.*Nz+( ...
  -2).*dNydx.*dNzdx.*Nx.*Ny.*Nz+2.*dNydy.*dNzdy.*Nx.*Ny.*Nz+2.* ...
  dNydz.*dNzdz.*Nx.*Ny.*Nz+2.*dNzdy.*dNzdz.*Nx.*Ny.*Nz+4.*d2Nxdydz.* ...
  Nx.^2.*Ny.*Nz+2.*d2Nydxdz.*Nx.^2.*Ny.*Nz+2.*d2Nzdxdy.*Nx.^2.*Ny.* ...
  Nz+3.*dNxdz.*dNydy.*Ny.^2.*Nz+(-2).*dNydx.*dNydz.*Ny.^2.*Nz+(-1).* ...
  dNydy.*dNzdx.*Ny.^2.*Nz+(-1).*dNydx.*dNzdy.*Ny.^2.*Nz+2.*dNxdz.* ...
  dNzdz.*Ny.^2.*Nz+(-1).*dNzdx.*dNzdz.*Ny.^2.*Nz+2.*d2Nxdxdz.*Nx.* ...
  Ny.^2.*Nz+2.*d2Nydydz.*Nx.*Ny.^2.*Nz+d2Nzdydy.*Nx.*Ny.^2.*Nz+2.* ...
  d2Nxdydz.*Ny.^3.*Nz+(-1).*d2Nxdxdx.*Nz.^2+(-1).*d2Nxdzdz.*Nz.^2+( ...
  -1).*d2Nydxdy.*Nz.^2+(-2).*d2Nzdxdz.*Nz.^2+2.*dNxdz.^2.*Nx.*Nz.^2+ ...
  (-1).*dNydx.^2.*Nx.*Nz.^2+3.*dNxdz.*dNzdx.*Nx.*Nz.^2+(-2).* ...
  dNzdx.^2.*Nx.*Nz.^2+dNydz.*dNzdy.*Nx.*Nz.^2+dNydy.*dNzdz.*Nx.* ...
  Nz.^2+2.*dNzdz.^2.*Nx.*Nz.^2+d2Nxdxdx.*Nx.^2.*Nz.^2+2.*d2Nxdzdz.* ...
  Nx.^2.*Nz.^2+2.*d2Nzdxdz.*Nx.^2.*Nz.^2+(-1).*dNydx.*dNydy.*Ny.* ...
  Nz.^2+2.*dNxdz.*dNydz.*Ny.*Nz.^2+(-1).*dNydz.*dNzdx.*Ny.*Nz.^2+3.* ...
  dNxdz.*dNzdy.*Ny.*Nz.^2+(-2).*dNzdx.*dNzdy.*Ny.*Nz.^2+(-1).* ...
  dNydx.*dNzdz.*Ny.*Nz.^2+2.*d2Nxdxdy.*Nx.*Ny.*Nz.^2+d2Nydzdz.*Nx.* ...
  Ny.*Nz.^2+2.*d2Nzdydz.*Nx.*Ny.*Nz.^2+d2Nxdydy.*Ny.^2.*Nz.^2+ ...
  d2Nxdzdz.*Ny.^2.*Nz.^2+dNxdz.*dNydy.*Nz.^3+(-1).*dNydx.*dNydz.* ...
  Nz.^3+4.*dNxdz.*dNzdz.*Nz.^3+(-2).*dNzdx.*dNzdz.*Nz.^3+2.* ...
  d2Nxdxdz.*Nx.*Nz.^3+d2Nzdzdz.*Nx.*Nz.^3+2.*d2Nxdydz.*Ny.*Nz.^3+ ...
  d2Nxdzdz.*Nz.^4+dNxdx.^2.*Nx.*((-4)+4.*Nx.^2+Ny.^2+Nz.^2)+dNxdy.*( ...
  (-1).*dNzdz.*Ny+2.*dNzdz.*Nx.^2.*Ny+dNzdz.*Ny.^3+(-1).*dNydz.*Nz+ ...
  2.*dNydz.*Nx.^2.*Nz+4.*dNxdz.*Nx.*Ny.*Nz+2.*dNzdx.*Nx.*Ny.*Nz+3.* ...
  dNydz.*Ny.^2.*Nz+2.*dNzdy.*Ny.^2.*Nz+3.*dNzdz.*Ny.*Nz.^2+dNydz.* ...
  Nz.^3+2.*dNydy.*Ny.*((-1)+2.*Nx.^2+2.*Ny.^2+Nz.^2)+dNydx.*Nx.*(( ...
  -2)+2.*Nx.^2+3.*Ny.^2+Nz.^2))+dNxdx.*((-2).*dNxdy.*Ny+(-2).* ...
  dNydx.*Ny+6.*dNxdy.*Nx.^2.*Ny+2.*dNydx.*Nx.^2.*Ny+dNxdy.*Ny.^3+( ...
  -2).*dNxdz.*Nz+(-2).*dNzdx.*Nz+6.*dNxdz.*Nx.^2.*Nz+2.*dNzdx.* ...
  Nx.^2.*Nz+2.*dNydz.*Nx.*Ny.*Nz+2.*dNzdy.*Nx.*Ny.*Nz+dNxdz.*Ny.^2.* ...
  Nz+dNxdy.*Ny.*Nz.^2+dNxdz.*Nz.^3+dNydy.*Nx.*((-2)+2.*Nx.^2+3.* ...
  Ny.^2+Nz.^2)+dNzdz.*Nx.*((-2)+2.*Nx.^2+Ny.^2+3.*Nz.^2)))+K33.*( ...
  dNydx.^2.*Nx.^3+(-2).*dNxdz.*dNzdx.*Nx.^3+dNzdx.^2.*Nx.^3+(-2).* ...
  d2Nxdxdx.*Nx.^4+(-1).*dNydx.*dNydy.*Nx.^2.*Ny+(-1).*dNydz.*dNzdx.* ...
  Nx.^2.*Ny+(-2).*dNxdz.*dNzdy.*Nx.^2.*Ny+dNzdx.*dNzdy.*Nx.^2.*Ny+( ...
  -1).*dNydx.*dNzdz.*Nx.^2.*Ny+(-4).*d2Nxdxdy.*Nx.^3.*Ny+(-1).* ...
  d2Nydxdx.*Nx.^3.*Ny+(-2).*dNxdy.^2.*Nx.*Ny.^2+2.*dNydx.^2.*Nx.* ...
  Ny.^2+(-2).*dNydy.^2.*Nx.*Ny.^2+(-1).*dNxdz.*dNzdx.*Nx.*Ny.^2+ ...
  dNzdx.^2.*Nx.*Ny.^2+(-1).*dNydz.*dNzdy.*Nx.*Ny.^2+(-1).*dNydy.* ...
  dNzdz.*Nx.*Ny.^2+(-1).*d2Nxdxdx.*Nx.^2.*Ny.^2+(-2).*d2Nxdydy.* ...
  Nx.^2.*Ny.^2+(-2).*d2Nydxdy.*Nx.^2.*Ny.^2+2.*dNydx.*dNydy.*Ny.^3+( ...
  -1).*dNxdz.*dNzdy.*Ny.^3+dNzdx.*dNzdy.*Ny.^3+(-2).*d2Nxdxdy.*Nx.* ...
  Ny.^3+(-1).*d2Nydydy.*Nx.*Ny.^3+(-1).*d2Nxdydy.*Ny.^4+(-2).* ...
  dNxdz.*dNydy.*Nx.^2.*Nz+dNydx.*dNydz.*Nx.^2.*Nz+(-1).*dNydy.* ...
  dNzdx.*Nx.^2.*Nz+(-1).*dNydx.*dNzdy.*Nx.^2.*Nz+(-4).*dNxdz.* ...
  dNzdz.*Nx.^2.*Nz+(-1).*dNzdx.*dNzdz.*Nx.^2.*Nz+(-4).*d2Nxdxdz.* ...
  Nx.^3.*Nz+(-1).*d2Nzdxdx.*Nx.^3.*Nz+(-2).*dNxdz.*dNydx.*Nx.*Ny.* ...
  Nz+(-2).*dNydy.*dNydz.*Nx.*Ny.*Nz+2.*dNydx.*dNzdx.*Nx.*Ny.*Nz+(-2) ...
  .*dNydy.*dNzdy.*Nx.*Ny.*Nz+(-2).*dNydz.*dNzdz.*Nx.*Ny.*Nz+(-2).* ...
  dNzdy.*dNzdz.*Nx.*Ny.*Nz+(-4).*d2Nxdydz.*Nx.^2.*Ny.*Nz+(-2).* ...
  d2Nydxdz.*Nx.^2.*Ny.*Nz+(-2).*d2Nzdxdy.*Nx.^2.*Ny.*Nz+(-3).* ...
  dNxdz.*dNydy.*Ny.^2.*Nz+2.*dNydx.*dNydz.*Ny.^2.*Nz+dNydy.*dNzdx.* ...
  Ny.^2.*Nz+dNydx.*dNzdy.*Ny.^2.*Nz+(-2).*dNxdz.*dNzdz.*Ny.^2.*Nz+ ...
  dNzdx.*dNzdz.*Ny.^2.*Nz+(-2).*d2Nxdxdz.*Nx.*Ny.^2.*Nz+(-2).* ...
  d2Nydydz.*Nx.*Ny.^2.*Nz+(-1).*d2Nzdydy.*Nx.*Ny.^2.*Nz+(-2).* ...
  d2Nxdydz.*Ny.^3.*Nz+(-2).*dNxdz.^2.*Nx.*Nz.^2+dNydx.^2.*Nx.*Nz.^2+ ...
  (-3).*dNxdz.*dNzdx.*Nx.*Nz.^2+2.*dNzdx.^2.*Nx.*Nz.^2+(-1).*dNydz.* ...
  dNzdy.*Nx.*Nz.^2+(-1).*dNydy.*dNzdz.*Nx.*Nz.^2+(-2).*dNzdz.^2.* ...
  Nx.*Nz.^2+(-1).*d2Nxdxdx.*Nx.^2.*Nz.^2+(-2).*d2Nxdzdz.*Nx.^2.* ...
  Nz.^2+(-2).*d2Nzdxdz.*Nx.^2.*Nz.^2+dNydx.*dNydy.*Ny.*Nz.^2+(-2).* ...
  dNxdz.*dNydz.*Ny.*Nz.^2+dNydz.*dNzdx.*Ny.*Nz.^2+(-3).*dNxdz.* ...
  dNzdy.*Ny.*Nz.^2+2.*dNzdx.*dNzdy.*Ny.*Nz.^2+dNydx.*dNzdz.*Ny.* ...
  Nz.^2+(-2).*d2Nxdxdy.*Nx.*Ny.*Nz.^2+(-1).*d2Nydzdz.*Nx.*Ny.*Nz.^2+ ...
  (-2).*d2Nzdydz.*Nx.*Ny.*Nz.^2+(-1).*d2Nxdydy.*Ny.^2.*Nz.^2+(-1).* ...
  d2Nxdzdz.*Ny.^2.*Nz.^2+(-1).*dNxdz.*dNydy.*Nz.^3+dNydx.*dNydz.* ...
  Nz.^3+(-4).*dNxdz.*dNzdz.*Nz.^3+2.*dNzdx.*dNzdz.*Nz.^3+(-2).* ...
  d2Nxdxdz.*Nx.*Nz.^3+(-1).*d2Nzdzdz.*Nx.*Nz.^3+(-2).*d2Nxdydz.*Ny.* ...
  Nz.^3+(-1).*d2Nxdzdz.*Nz.^4+(-1).*dNxdx.^2.*Nx.*(4.*Nx.^2+Ny.^2+ ...
  Nz.^2)+(-1).*dNxdy.*(2.*dNzdz.*Nx.^2.*Ny+dNzdz.*Ny.^3+2.*dNydz.* ...
  Nx.^2.*Nz+4.*dNxdz.*Nx.*Ny.*Nz+2.*dNzdx.*Nx.*Ny.*Nz+3.*dNydz.* ...
  Ny.^2.*Nz+2.*dNzdy.*Ny.^2.*Nz+3.*dNzdz.*Ny.*Nz.^2+dNydz.*Nz.^3+2.* ...
  dNydy.*Ny.*(2.*Nx.^2+2.*Ny.^2+Nz.^2)+dNydx.*Nx.*(2.*Nx.^2+3.* ...
  Ny.^2+Nz.^2))+(-1).*dNxdx.*(6.*dNxdy.*Nx.^2.*Ny+2.*dNydx.*Nx.^2.* ...
  Ny+dNxdy.*Ny.^3+6.*dNxdz.*Nx.^2.*Nz+2.*dNzdx.*Nx.^2.*Nz+2.*dNydz.* ...
  Nx.*Ny.*Nz+2.*dNzdy.*Nx.*Ny.*Nz+dNxdz.*Ny.^2.*Nz+dNxdy.*Ny.*Nz.^2+ ...
  dNxdz.*Nz.^3+dNydy.*Nx.*(2.*Nx.^2+3.*Ny.^2+Nz.^2)+dNzdz.*Nx.*(2.* ...
  Nx.^2+Ny.^2+3.*Nz.^2)));


ELy = K22.*((-2).*dNxdz.*dNydz.*Nx+dNydz.*dNzdx.*Nx+dNxdz.*dNzdy.*Nx+ ...
  dNxdy.*dNzdz.*Nx+2.*d2Nxdxdy.*Nx.^2+(-1).*d2Nydzdz.*Nx.^2+ ...
  d2Nzdydz.*Nx.^2+(-2).*dNydx.^2.*Ny+2.*dNydy.^2.*Ny+(-2).* ...
  dNydz.^2.*Ny+2.*dNydz.*dNzdy.*Ny+2.*dNydy.*dNzdz.*Ny+(-1).* ...
  d2Nxdzdz.*Nx.*Ny+4.*d2Nydxdy.*Nx.*Ny+d2Nzdxdz.*Nx.*Ny+2.* ...
  d2Nxdxdy.*Ny.^2+(-2).*d2Nydxdx.*Ny.^2+2.*d2Nydydy.*Ny.^2+(-2).* ...
  d2Nydzdz.*Ny.^2+2.*d2Nzdydz.*Ny.^2+2.*dNydy.*dNydz.*Nz+dNxdy.* ...
  dNzdx.*Nz+2.*dNzdy.*dNzdz.*Nz+d2Nxdydz.*Nx.*Nz+2.*d2Nydxdz.*Nx.* ...
  Nz+d2Nzdxdy.*Nx.*Nz+d2Nxdxdz.*Ny.*Nz+4.*d2Nydydz.*Ny.*Nz+(-1).* ...
  d2Nzdxdx.*Ny.*Nz+d2Nxdxdy.*Nz.^2+(-1).*d2Nydxdx.*Nz.^2+2.* ...
  d2Nzdydz.*Nz.^2+dNydx.*(2.*dNydy.*Nx+dNzdz.*Nx+2.*dNxdy.*Ny+ ...
  dNxdz.*Nz+(-2).*dNzdx.*Nz)+dNxdx.*(2.*dNxdy.*Nx+2.*dNydy.*Ny+( ...
  dNydz+dNzdy).*Nz))+K11.*((-2).*dNydx.*dNydy.*Nx+(-1).*dNydz.* ...
  dNzdx.*Nx+(-1).*dNxdz.*dNzdy.*Nx+(-1).*dNydx.*dNzdz.*Nx+(-2).* ...
  d2Nxdxdy.*Nx.^2+(-1).*d2Nydxdx.*Nx.^2+(-1).*d2Nydydy.*Nx.^2+(-1).* ...
  d2Nzdydz.*Nx.^2+dNydx.*dNydy.*Nx.^3+dNydz.*dNzdx.*Nx.^3+(-1).* ...
  dNzdx.*dNzdy.*Nx.^3+dNydx.*dNzdz.*Nx.^3+d2Nydxdx.*Nx.^4+(-4).* ...
  dNydy.^2.*Ny+(-2).*dNydz.*dNzdy.*Ny+(-2).*dNydy.*dNzdz.*Ny+(-1).* ...
  d2Nxdxdx.*Nx.*Ny+(-1).*d2Nxdydy.*Nx.*Ny+(-4).*d2Nydxdy.*Nx.*Ny+( ...
  -1).*d2Nzdxdz.*Nx.*Ny+2.*dNxdx.^2.*Nx.^2.*Ny+2.*dNydx.^2.*Nx.^2.* ...
  Ny+dNydy.^2.*Nx.^2.*Ny+dNxdz.*dNzdx.*Nx.^2.*Ny+dNydz.*dNzdy.* ...
  Nx.^2.*Ny+(-1).*dNzdy.^2.*Nx.^2.*Ny+dNydy.*dNzdz.*Nx.^2.*Ny+ ...
  d2Nxdxdx.*Nx.^3.*Ny+2.*d2Nydxdy.*Nx.^3.*Ny+(-2).*d2Nxdxdy.*Ny.^2+( ...
  -4).*d2Nydydy.*Ny.^2+(-2).*d2Nzdydz.*Ny.^2+6.*dNydx.*dNydy.*Nx.* ...
  Ny.^2+2.*dNydz.*dNzdx.*Nx.*Ny.^2+dNxdz.*dNzdy.*Nx.*Ny.^2+(-1).* ...
  dNzdx.*dNzdy.*Nx.*Ny.^2+2.*dNydx.*dNzdz.*Nx.*Ny.^2+2.*d2Nxdxdy.* ...
  Nx.^2.*Ny.^2+2.*d2Nydxdx.*Nx.^2.*Ny.^2+d2Nydydy.*Nx.^2.*Ny.^2+4.* ...
  dNydy.^2.*Ny.^3+2.*dNydz.*dNzdy.*Ny.^3+(-1).*dNzdy.^2.*Ny.^3+2.* ...
  dNydy.*dNzdz.*Ny.^3+d2Nxdydy.*Nx.*Ny.^3+4.*d2Nydxdy.*Nx.*Ny.^3+2.* ...
  d2Nydydy.*Ny.^4+(-1).*dNxdz.*dNydx.*Nz+(-2).*dNydy.*dNydz.*Nz+(-2) ...
  .*dNydy.*dNzdy.*Nz+(-2).*dNydz.*dNzdz.*Nz+(-2).*dNzdy.*dNzdz.*Nz+( ...
  -1).*d2Nxdydz.*Nx.*Nz+(-2).*d2Nydxdz.*Nx.*Nz+(-1).*d2Nzdxdy.*Nx.* ...
  Nz+3.*dNxdz.*dNydx.*Nx.^2.*Nz+dNydy.*dNydz.*Nx.^2.*Nz+2.*dNydx.* ...
  dNzdx.*Nx.^2.*Nz+2.*dNydz.*dNzdz.*Nx.^2.*Nz+(-1).*dNzdy.*dNzdz.* ...
  Nx.^2.*Nz+2.*d2Nydxdz.*Nx.^3.*Nz+(-1).*d2Nxdxdz.*Ny.*Nz+(-4).* ...
  d2Nydydz.*Ny.*Nz+(-1).*d2Nzdydy.*Ny.*Nz+(-1).*d2Nzdzdz.*Ny.*Nz+2.* ...
  dNxdz.*dNydy.*Nx.*Ny.*Nz+4.*dNydx.*dNydz.*Nx.*Ny.*Nz+2.*dNydy.* ...
  dNzdx.*Nx.*Ny.*Nz+2.*dNydx.*dNzdy.*Nx.*Ny.*Nz+2.*dNxdz.*dNzdz.* ...
  Nx.*Ny.*Nz+2.*dNzdx.*dNzdz.*Nx.*Ny.*Nz+2.*d2Nxdxdz.*Nx.^2.*Ny.*Nz+ ...
  2.*d2Nydydz.*Nx.^2.*Ny.*Nz+d2Nzdxdx.*Nx.^2.*Ny.*Nz+2.*dNxdz.* ...
  dNydx.*Ny.^2.*Nz+6.*dNydy.*dNydz.*Ny.^2.*Nz+2.*dNydy.*dNzdy.* ...
  Ny.^2.*Nz+4.*dNydz.*dNzdz.*Ny.^2.*Nz+dNzdy.*dNzdz.*Ny.^2.*Nz+2.* ...
  d2Nxdydz.*Nx.*Ny.^2.*Nz+4.*d2Nydxdz.*Nx.*Ny.^2.*Nz+2.*d2Nzdxdy.* ...
  Nx.*Ny.^2.*Nz+4.*d2Nydydz.*Ny.^3.*Nz+d2Nzdydy.*Ny.^3.*Nz+(-1).* ...
  d2Nxdxdy.*Nz.^2+(-1).*d2Nydydy.*Nz.^2+(-1).*d2Nydzdz.*Nz.^2+(-2).* ...
  d2Nzdydz.*Nz.^2+dNydx.*dNydy.*Nx.*Nz.^2+2.*dNxdz.*dNydz.*Nx.* ...
  Nz.^2+3.*dNydz.*dNzdx.*Nx.*Nz.^2+(-1).*dNxdz.*dNzdy.*Nx.*Nz.^2+( ...
  -2).*dNzdx.*dNzdy.*Nx.*Nz.^2+3.*dNydx.*dNzdz.*Nx.*Nz.^2+d2Nydxdx.* ...
  Nx.^2.*Nz.^2+d2Nydzdz.*Nx.^2.*Nz.^2+dNydy.^2.*Ny.*Nz.^2+2.* ...
  dNydz.^2.*Ny.*Nz.^2+dNxdz.*dNzdx.*Ny.*Nz.^2+3.*dNydz.*dNzdy.*Ny.* ...
  Nz.^2+(-2).*dNzdy.^2.*Ny.*Nz.^2+3.*dNydy.*dNzdz.*Ny.*Nz.^2+2.* ...
  dNzdz.^2.*Ny.*Nz.^2+d2Nxdzdz.*Nx.*Ny.*Nz.^2+2.*d2Nydxdy.*Nx.*Ny.* ...
  Nz.^2+2.*d2Nzdxdz.*Nx.*Ny.*Nz.^2+d2Nydydy.*Ny.^2.*Nz.^2+2.* ...
  d2Nydzdz.*Ny.^2.*Nz.^2+2.*d2Nzdydz.*Ny.^2.*Nz.^2+dNxdz.*dNydx.* ...
  Nz.^3+dNydy.*dNydz.*Nz.^3+4.*dNydz.*dNzdz.*Nz.^3+(-2).*dNzdy.* ...
  dNzdz.*Nz.^3+2.*d2Nydxdz.*Nx.*Nz.^3+2.*d2Nydydz.*Ny.*Nz.^3+ ...
  d2Nzdzdz.*Ny.*Nz.^3+d2Nydzdz.*Nz.^4+(-1).*dNxdy.^2.*Ny.*(2.*Nx.^2+ ...
  Ny.^2+Nz.^2)+dNxdy.*((-2).*dNydx.*Ny+3.*dNydx.*Nx.^2.*Ny+2.* ...
  dNydx.*Ny.^3+2.*dNydy.*Nx.*((-1)+Ny.^2)+(-1).*dNzdx.*Nz+(-2).* ...
  dNxdz.*Nx.^2.*Nz+(-1).*dNzdx.*Nx.^2.*Nz+2.*dNydz.*Nx.*Ny.*Nz+(-2) ...
  .*dNzdy.*Nx.*Ny.*Nz+(-1).*dNxdz.*Ny.^2.*Nz+dNzdx.*Ny.^2.*Nz+ ...
  dNydx.*Ny.*Nz.^2+(-1).*dNxdz.*Nz.^3+dNzdz.*Nx.*((-1)+Ny.^2+(-1).* ...
  Nz.^2))+dNxdx.*((-2).*dNydy.*Ny+3.*dNydy.*Nx.^2.*Ny+dNzdz.*Nx.^2.* ...
  Ny+2.*dNydy.*Ny.^3+(-1).*dNydz.*Nz+(-1).*dNzdy.*Nz+3.*dNydz.* ...
  Nx.^2.*Nz+(-1).*dNzdy.*Nx.^2.*Nz+2.*dNxdz.*Nx.*Ny.*Nz+2.*dNzdx.* ...
  Nx.*Ny.*Nz+2.*dNydz.*Ny.^2.*Nz+dNzdy.*Ny.^2.*Nz+dNydy.*Ny.*Nz.^2+ ...
  dNzdz.*Ny.*Nz.^2+dNydz.*Nz.^3+(-1).*dNxdy.*Nx.*(2+2.*Nx.^2+(-1).* ...
  Ny.^2+Nz.^2)+2.*dNydx.*Nx.*((-1)+2.*Nx.^2+2.*Ny.^2+Nz.^2)))+K33.*( ...
  (-1).*dNydz.*dNzdx.*Nx.^3+dNzdx.*dNzdy.*Nx.^3+(-1).*d2Nydxdx.* ...
  Nx.^4+(-2).*dNxdx.^2.*Nx.^2.*Ny+2.*dNxdy.^2.*Nx.^2.*Ny+(-2).* ...
  dNydx.^2.*Nx.^2.*Ny+(-1).*dNydy.^2.*Nx.^2.*Ny+(-1).*dNxdz.*dNzdx.* ...
  Nx.^2.*Ny+(-1).*dNydz.*dNzdy.*Nx.^2.*Ny+dNzdy.^2.*Nx.^2.*Ny+(-1).* ...
  dNydy.*dNzdz.*Nx.^2.*Ny+(-1).*d2Nxdxdx.*Nx.^3.*Ny+(-2).*d2Nydxdy.* ...
  Nx.^3.*Ny+(-2).*dNxdy.*dNydy.*Nx.*Ny.^2+(-2).*dNydz.*dNzdx.*Nx.* ...
  Ny.^2+(-1).*dNxdz.*dNzdy.*Nx.*Ny.^2+dNzdx.*dNzdy.*Nx.*Ny.^2+(-1).* ...
  dNxdy.*dNzdz.*Nx.*Ny.^2+(-2).*d2Nxdxdy.*Nx.^2.*Ny.^2+(-2).* ...
  d2Nydxdx.*Nx.^2.*Ny.^2+(-1).*d2Nydydy.*Nx.^2.*Ny.^2+dNxdy.^2.* ...
  Ny.^3+(-4).*dNydy.^2.*Ny.^3+(-2).*dNydz.*dNzdy.*Ny.^3+dNzdy.^2.* ...
  Ny.^3+(-2).*dNydy.*dNzdz.*Ny.^3+(-1).*d2Nxdydy.*Nx.*Ny.^3+(-4).* ...
  d2Nydxdy.*Nx.*Ny.^3+(-2).*d2Nydydy.*Ny.^4+2.*dNxdy.*dNxdz.*Nx.^2.* ...
  Nz+(-1).*dNydy.*dNydz.*Nx.^2.*Nz+dNxdy.*dNzdx.*Nx.^2.*Nz+(-2).* ...
  dNydz.*dNzdz.*Nx.^2.*Nz+dNzdy.*dNzdz.*Nx.^2.*Nz+(-2).*d2Nydxdz.* ...
  Nx.^3.*Nz+(-2).*dNxdz.*dNydy.*Nx.*Ny.*Nz+(-2).*dNxdy.*dNydz.*Nx.* ...
  Ny.*Nz+(-2).*dNydy.*dNzdx.*Nx.*Ny.*Nz+2.*dNxdy.*dNzdy.*Nx.*Ny.*Nz+ ...
  (-2).*dNxdz.*dNzdz.*Nx.*Ny.*Nz+(-2).*dNzdx.*dNzdz.*Nx.*Ny.*Nz+(-2) ...
  .*d2Nxdxdz.*Nx.^2.*Ny.*Nz+(-2).*d2Nydydz.*Nx.^2.*Ny.*Nz+(-1).* ...
  d2Nzdxdx.*Nx.^2.*Ny.*Nz+dNxdy.*dNxdz.*Ny.^2.*Nz+(-6).*dNydy.* ...
  dNydz.*Ny.^2.*Nz+(-1).*dNxdy.*dNzdx.*Ny.^2.*Nz+(-2).*dNydy.* ...
  dNzdy.*Ny.^2.*Nz+(-4).*dNydz.*dNzdz.*Ny.^2.*Nz+(-1).*dNzdy.* ...
  dNzdz.*Ny.^2.*Nz+(-2).*d2Nxdydz.*Nx.*Ny.^2.*Nz+(-4).*d2Nydxdz.* ...
  Nx.*Ny.^2.*Nz+(-2).*d2Nzdxdy.*Nx.*Ny.^2.*Nz+(-4).*d2Nydydz.* ...
  Ny.^3.*Nz+(-1).*d2Nzdydy.*Ny.^3.*Nz+(-2).*dNxdz.*dNydz.*Nx.*Nz.^2+ ...
  (-3).*dNydz.*dNzdx.*Nx.*Nz.^2+dNxdz.*dNzdy.*Nx.*Nz.^2+2.*dNzdx.* ...
  dNzdy.*Nx.*Nz.^2+dNxdy.*dNzdz.*Nx.*Nz.^2+(-1).*d2Nydxdx.*Nx.^2.* ...
  Nz.^2+(-1).*d2Nydzdz.*Nx.^2.*Nz.^2+dNxdy.^2.*Ny.*Nz.^2+(-1).* ...
  dNydy.^2.*Ny.*Nz.^2+(-2).*dNydz.^2.*Ny.*Nz.^2+(-1).*dNxdz.*dNzdx.* ...
  Ny.*Nz.^2+(-3).*dNydz.*dNzdy.*Ny.*Nz.^2+2.*dNzdy.^2.*Ny.*Nz.^2+( ...
  -3).*dNydy.*dNzdz.*Ny.*Nz.^2+(-2).*dNzdz.^2.*Ny.*Nz.^2+(-1).* ...
  d2Nxdzdz.*Nx.*Ny.*Nz.^2+(-2).*d2Nydxdy.*Nx.*Ny.*Nz.^2+(-2).* ...
  d2Nzdxdz.*Nx.*Ny.*Nz.^2+(-1).*d2Nydydy.*Ny.^2.*Nz.^2+(-2).* ...
  d2Nydzdz.*Ny.^2.*Nz.^2+(-2).*d2Nzdydz.*Ny.^2.*Nz.^2+dNxdy.*dNxdz.* ...
  Nz.^3+(-1).*dNydy.*dNydz.*Nz.^3+(-4).*dNydz.*dNzdz.*Nz.^3+2.* ...
  dNzdy.*dNzdz.*Nz.^3+(-2).*d2Nydxdz.*Nx.*Nz.^3+(-2).*d2Nydydz.*Ny.* ...
  Nz.^3+(-1).*d2Nzdzdz.*Ny.*Nz.^3+(-1).*d2Nydzdz.*Nz.^4+(-1).* ...
  dNxdx.*(3.*dNydy.*Nx.^2.*Ny+dNzdz.*Nx.^2.*Ny+2.*dNydy.*Ny.^3+3.* ...
  dNydz.*Nx.^2.*Nz+(-1).*dNzdy.*Nx.^2.*Nz+2.*dNxdz.*Nx.*Ny.*Nz+2.* ...
  dNzdx.*Nx.*Ny.*Nz+2.*dNydz.*Ny.^2.*Nz+dNzdy.*Ny.^2.*Nz+dNydy.*Ny.* ...
  Nz.^2+dNzdz.*Ny.*Nz.^2+dNydz.*Nz.^3+dNxdy.*Nx.*((-2).*Nx.^2+Ny.^2+ ...
  (-1).*Nz.^2)+2.*dNydx.*Nx.*(2.*Nx.^2+2.*Ny.^2+Nz.^2))+(-1).* ...
  dNydx.*(3.*dNxdy.*Nx.^2.*Ny+2.*dNxdy.*Ny.^3+3.*dNxdz.*Nx.^2.*Nz+ ...
  2.*dNzdx.*Nx.^2.*Nz+4.*dNydz.*Nx.*Ny.*Nz+2.*dNzdy.*Nx.*Ny.*Nz+2.* ...
  dNxdz.*Ny.^2.*Nz+dNxdy.*Ny.*Nz.^2+dNxdz.*Nz.^3+dNydy.*Nx.*(Nx.^2+ ...
  6.*Ny.^2+Nz.^2)+dNzdz.*Nx.*(Nx.^2+2.*Ny.^2+3.*Nz.^2)));

ELz = K22.*(dNxdy.*dNydz.*Nx+dNydy.*dNzdx.*Nx+(-2).*dNxdy.*dNzdy.*Nx+ ...
  dNydx.*dNzdy.*Nx+2.*dNzdx.*dNzdz.*Nx+2.*d2Nxdxdz.*Nx.^2+d2Nydydz.* ...
  Nx.^2+(-1).*d2Nzdydy.*Nx.^2+2.*dNydy.*dNydz.*Ny+dNxdy.*dNzdx.*Ny+( ...
  -2).*dNydx.*dNzdx.*Ny+2.*dNzdy.*dNzdz.*Ny+d2Nxdydz.*Nx.*Ny+ ...
  d2Nydxdz.*Nx.*Ny+2.*d2Nzdxdy.*Nx.*Ny+d2Nxdxdz.*Ny.^2+2.*d2Nydydz.* ...
  Ny.^2+(-1).*d2Nzdxdx.*Ny.^2+(-2).*dNzdx.^2.*Nz+2.*dNydz.*dNzdy.* ...
  Nz+(-2).*dNzdy.^2.*Nz+2.*dNydy.*dNzdz.*Nz+2.*dNzdz.^2.*Nz+(-1).* ...
  d2Nxdydy.*Nx.*Nz+d2Nydxdy.*Nx.*Nz+4.*d2Nzdxdz.*Nx.*Nz+d2Nxdxdy.* ...
  Ny.*Nz+(-1).*d2Nydxdx.*Ny.*Nz+4.*d2Nzdydz.*Ny.*Nz+2.*d2Nxdxdz.* ...
  Nz.^2+2.*d2Nydydz.*Nz.^2+(-2).*d2Nzdxdx.*Nz.^2+(-2).*d2Nzdydy.* ...
  Nz.^2+2.*d2Nzdzdz.*Nz.^2+dNxdz.*(dNydy.*Nx+dNydx.*Ny+2.*dNzdx.*Nz) ...
  +dNxdx.*(2.*dNxdz.*Nx+dNydz.*Ny+dNzdy.*Ny+2.*dNzdz.*Nz))+K11.*(( ...
  -1).*dNxdy.*dNydz.*Nx+(-1).*dNydy.*dNzdx.*Nx+(-1).*dNydx.*dNzdy.* ...
  Nx+(-2).*dNzdx.*dNzdz.*Nx+(-2).*d2Nxdxdz.*Nx.^2+(-1).*d2Nydydz.* ...
  Nx.^2+(-1).*d2Nzdxdx.*Nx.^2+(-1).*d2Nzdzdz.*Nx.^2+(-1).*dNydx.* ...
  dNydz.*Nx.^3+dNydy.*dNzdx.*Nx.^3+dNydx.*dNzdy.*Nx.^3+dNzdx.* ...
  dNzdz.*Nx.^3+d2Nzdxdx.*Nx.^4+(-2).*dNydy.*dNydz.*Ny+(-1).*dNxdy.* ...
  dNzdx.*Ny+(-2).*dNydy.*dNzdy.*Ny+(-2).*dNydz.*dNzdz.*Ny+(-2).* ...
  dNzdy.*dNzdz.*Ny+(-1).*d2Nxdydz.*Nx.*Ny+(-1).*d2Nydxdz.*Nx.*Ny+( ...
  -2).*d2Nzdxdy.*Nx.*Ny+(-1).*dNydy.*dNydz.*Nx.^2.*Ny+3.*dNxdy.* ...
  dNzdx.*Nx.^2.*Ny+2.*dNydx.*dNzdx.*Nx.^2.*Ny+2.*dNydy.*dNzdy.* ...
  Nx.^2.*Ny+dNzdy.*dNzdz.*Nx.^2.*Ny+2.*d2Nzdxdy.*Nx.^3.*Ny+(-1).* ...
  d2Nxdxdz.*Ny.^2+(-2).*d2Nydydz.*Ny.^2+(-1).*d2Nzdydy.*Ny.^2+(-1).* ...
  d2Nzdzdz.*Ny.^2+(-1).*dNxdy.*dNydz.*Nx.*Ny.^2+(-2).*dNydx.*dNydz.* ...
  Nx.*Ny.^2+3.*dNydy.*dNzdx.*Nx.*Ny.^2+2.*dNxdy.*dNzdy.*Nx.*Ny.^2+ ...
  3.*dNydx.*dNzdy.*Nx.*Ny.^2+dNzdx.*dNzdz.*Nx.*Ny.^2+d2Nzdxdx.* ...
  Nx.^2.*Ny.^2+d2Nzdydy.*Nx.^2.*Ny.^2+(-2).*dNydy.*dNydz.*Ny.^3+ ...
  dNxdy.*dNzdx.*Ny.^3+4.*dNydy.*dNzdy.*Ny.^3+dNzdy.*dNzdz.*Ny.^3+2.* ...
  d2Nzdxdy.*Nx.*Ny.^3+d2Nzdydy.*Ny.^4+(-2).*dNydz.*dNzdy.*Nz+(-2).* ...
  dNydy.*dNzdz.*Nz+(-4).*dNzdz.^2.*Nz+(-1).*d2Nxdxdx.*Nx.*Nz+(-1).* ...
  d2Nxdzdz.*Nx.*Nz+(-1).*d2Nydxdy.*Nx.*Nz+(-4).*d2Nzdxdz.*Nx.*Nz+2.* ...
  dNxdx.^2.*Nx.^2.*Nz+dNxdy.*dNydx.*Nx.^2.*Nz+(-1).*dNydz.^2.* ...
  Nx.^2.*Nz+2.*dNzdx.^2.*Nx.^2.*Nz+dNydz.*dNzdy.*Nx.^2.*Nz+dNydy.* ...
  dNzdz.*Nx.^2.*Nz+dNzdz.^2.*Nx.^2.*Nz+d2Nxdxdx.*Nx.^3.*Nz+2.* ...
  d2Nzdxdz.*Nx.^3.*Nz+(-1).*d2Nxdxdy.*Ny.*Nz+(-1).*d2Nydydy.*Ny.*Nz+ ...
  (-1).*d2Nydzdz.*Ny.*Nz+(-4).*d2Nzdydz.*Ny.*Nz+2.*dNxdy.*dNydy.* ...
  Nx.*Ny.*Nz+2.*dNydx.*dNydy.*Nx.*Ny.*Nz+2.*dNydz.*dNzdx.*Nx.*Ny.* ...
  Nz+4.*dNzdx.*dNzdy.*Nx.*Ny.*Nz+2.*dNxdy.*dNzdz.*Nx.*Ny.*Nz+2.* ...
  dNydx.*dNzdz.*Nx.*Ny.*Nz+2.*d2Nxdxdy.*Nx.^2.*Ny.*Nz+d2Nydxdx.* ...
  Nx.^2.*Ny.*Nz+2.*d2Nzdydz.*Nx.^2.*Ny.*Nz+dNxdy.*dNydx.*Ny.^2.*Nz+ ...
  2.*dNydy.^2.*Ny.^2.*Nz+(-2).*dNydz.^2.*Ny.^2.*Nz+3.*dNydz.*dNzdy.* ...
  Ny.^2.*Nz+2.*dNzdy.^2.*Ny.^2.*Nz+3.*dNydy.*dNzdz.*Ny.^2.*Nz+ ...
  dNzdz.^2.*Ny.^2.*Nz+d2Nxdydy.*Nx.*Ny.^2.*Nz+2.*d2Nydxdy.*Nx.* ...
  Ny.^2.*Nz+2.*d2Nzdxdz.*Nx.*Ny.^2.*Nz+d2Nydydy.*Ny.^3.*Nz+2.* ...
  d2Nzdydz.*Ny.^3.*Nz+(-2).*d2Nxdxdz.*Nz.^2+(-2).*d2Nydydz.*Nz.^2+( ...
  -4).*d2Nzdzdz.*Nz.^2+dNxdy.*dNydz.*Nx.*Nz.^2+(-1).*dNydx.*dNydz.* ...
  Nx.*Nz.^2+2.*dNydy.*dNzdx.*Nx.*Nz.^2+2.*dNydx.*dNzdy.*Nx.*Nz.^2+ ...
  6.*dNzdx.*dNzdz.*Nx.*Nz.^2+2.*d2Nxdxdz.*Nx.^2.*Nz.^2+2.*d2Nzdxdx.* ...
  Nx.^2.*Nz.^2+d2Nzdzdz.*Nx.^2.*Nz.^2+dNydy.*dNydz.*Ny.*Nz.^2+2.* ...
  dNxdy.*dNzdx.*Ny.*Nz.^2+4.*dNydy.*dNzdy.*Ny.*Nz.^2+2.*dNydz.* ...
  dNzdz.*Ny.*Nz.^2+6.*dNzdy.*dNzdz.*Ny.*Nz.^2+2.*d2Nxdydz.*Nx.*Ny.* ...
  Nz.^2+2.*d2Nydxdz.*Nx.*Ny.*Nz.^2+4.*d2Nzdxdy.*Nx.*Ny.*Nz.^2+2.* ...
  d2Nydydz.*Ny.^2.*Nz.^2+2.*d2Nzdydy.*Ny.^2.*Nz.^2+d2Nzdzdz.*Ny.^2.* ...
  Nz.^2+(-1).*dNydz.^2.*Nz.^3+2.*dNydz.*dNzdy.*Nz.^3+2.*dNydy.* ...
  dNzdz.*Nz.^3+4.*dNzdz.^2.*Nz.^3+d2Nxdzdz.*Nx.*Nz.^3+4.*d2Nzdxdz.* ...
  Nx.*Nz.^3+d2Nydzdz.*Ny.*Nz.^3+4.*d2Nzdydz.*Ny.*Nz.^3+2.*d2Nzdzdz.* ...
  Nz.^4+(-1).*dNxdz.^2.*Nz.*(2.*Nx.^2+Ny.^2+Nz.^2)+(-1).*dNxdz.*( ...
  dNydx.*Ny+2.*dNxdy.*Nx.^2.*Ny+dNydx.*Nx.^2.*Ny+dNxdy.*Ny.^3+2.* ...
  dNzdx.*Nz+(-3).*dNzdx.*Nx.^2.*Nz+2.*dNydz.*Nx.*Ny.*Nz+(-2).* ...
  dNzdy.*Nx.*Ny.*Nz+(-1).*dNzdx.*Ny.^2.*Nz+dNxdy.*Ny.*Nz.^2+(-1).* ...
  dNydx.*Ny.*Nz.^2+(-2).*dNzdx.*Nz.^3+dNydy.*Nx.*(1+Ny.^2+(-1).* ...
  Nz.^2)+(-2).*dNzdz.*Nx.*((-1)+Nz.^2))+dNxdx.*((-1).*dNydz.*Ny+(-1) ...
  .*dNzdy.*Ny+(-1).*dNydz.*Nx.^2.*Ny+3.*dNzdy.*Nx.^2.*Ny+dNzdy.* ...
  Ny.^3+(-2).*dNzdz.*Nz+dNydy.*Nx.^2.*Nz+3.*dNzdz.*Nx.^2.*Nz+2.* ...
  dNxdy.*Nx.*Ny.*Nz+2.*dNydx.*Nx.*Ny.*Nz+dNydy.*Ny.^2.*Nz+dNzdz.* ...
  Ny.^2.*Nz+dNydz.*Ny.*Nz.^2+2.*dNzdy.*Ny.*Nz.^2+2.*dNzdz.*Nz.^3+( ...
  -1).*dNxdz.*Nx.*(2+2.*Nx.^2+Ny.^2+(-1).*Nz.^2)+2.*dNzdx.*Nx.*((-1) ...
  +2.*Nx.^2+Ny.^2+2.*Nz.^2)))+K33.*((-1).*dNydy.*dNzdx.*Nx.^3+(-1).* ...
  dNzdx.*dNzdz.*Nx.^3+(-1).*d2Nzdxdx.*Nx.^4+2.*dNxdy.*dNxdz.*Nx.^2.* ...
  Ny+dNydy.*dNydz.*Nx.^2.*Ny+(-3).*dNxdy.*dNzdx.*Nx.^2.*Ny+(-2).* ...
  dNydy.*dNzdy.*Nx.^2.*Ny+(-1).*dNzdy.*dNzdz.*Nx.^2.*Ny+(-2).* ...
  d2Nzdxdy.*Nx.^3.*Ny+dNxdz.*dNydy.*Nx.*Ny.^2+dNxdy.*dNydz.*Nx.* ...
  Ny.^2+(-3).*dNydy.*dNzdx.*Nx.*Ny.^2+(-2).*dNxdy.*dNzdy.*Nx.*Ny.^2+ ...
  (-1).*dNzdx.*dNzdz.*Nx.*Ny.^2+(-1).*d2Nzdxdx.*Nx.^2.*Ny.^2+(-1).* ...
  d2Nzdydy.*Nx.^2.*Ny.^2+dNxdy.*dNxdz.*Ny.^3+2.*dNydy.*dNydz.*Ny.^3+ ...
  (-1).*dNxdy.*dNzdx.*Ny.^3+(-4).*dNydy.*dNzdy.*Ny.^3+(-1).*dNzdy.* ...
  dNzdz.*Ny.^3+(-2).*d2Nzdxdy.*Nx.*Ny.^3+(-1).*d2Nzdydy.*Ny.^4+(-2) ...
  .*dNxdx.^2.*Nx.^2.*Nz+2.*dNxdz.^2.*Nx.^2.*Nz+dNydz.^2.*Nx.^2.*Nz+( ...
  -3).*dNxdz.*dNzdx.*Nx.^2.*Nz+(-2).*dNzdx.^2.*Nx.^2.*Nz+(-1).* ...
  dNydz.*dNzdy.*Nx.^2.*Nz+(-1).*dNydy.*dNzdz.*Nx.^2.*Nz+(-1).* ...
  dNzdz.^2.*Nx.^2.*Nz+(-1).*d2Nxdxdx.*Nx.^3.*Nz+(-2).*d2Nzdxdz.* ...
  Nx.^3.*Nz+(-2).*dNxdy.*dNydy.*Nx.*Ny.*Nz+2.*dNxdz.*dNydz.*Nx.*Ny.* ...
  Nz+(-2).*dNydz.*dNzdx.*Nx.*Ny.*Nz+(-2).*dNxdz.*dNzdy.*Nx.*Ny.*Nz+( ...
  -4).*dNzdx.*dNzdy.*Nx.*Ny.*Nz+(-2).*dNxdy.*dNzdz.*Nx.*Ny.*Nz+(-2) ...
  .*d2Nxdxdy.*Nx.^2.*Ny.*Nz+(-1).*d2Nydxdx.*Nx.^2.*Ny.*Nz+(-2).* ...
  d2Nzdydz.*Nx.^2.*Ny.*Nz+dNxdz.^2.*Ny.^2.*Nz+(-2).*dNydy.^2.* ...
  Ny.^2.*Nz+2.*dNydz.^2.*Ny.^2.*Nz+(-1).*dNxdz.*dNzdx.*Ny.^2.*Nz+( ...
  -3).*dNydz.*dNzdy.*Ny.^2.*Nz+(-2).*dNzdy.^2.*Ny.^2.*Nz+(-3).* ...
  dNydy.*dNzdz.*Ny.^2.*Nz+(-1).*dNzdz.^2.*Ny.^2.*Nz+(-1).*d2Nxdydy.* ...
  Nx.*Ny.^2.*Nz+(-2).*d2Nydxdy.*Nx.*Ny.^2.*Nz+(-2).*d2Nzdxdz.*Nx.* ...
  Ny.^2.*Nz+(-1).*d2Nydydy.*Ny.^3.*Nz+(-2).*d2Nzdydz.*Ny.^3.*Nz+(-1) ...
  .*dNxdz.*dNydy.*Nx.*Nz.^2+(-1).*dNxdy.*dNydz.*Nx.*Nz.^2+(-2).* ...
  dNydy.*dNzdx.*Nx.*Nz.^2+(-2).*dNxdz.*dNzdz.*Nx.*Nz.^2+(-6).* ...
  dNzdx.*dNzdz.*Nx.*Nz.^2+(-2).*d2Nxdxdz.*Nx.^2.*Nz.^2+(-2).* ...
  d2Nzdxdx.*Nx.^2.*Nz.^2+(-1).*d2Nzdzdz.*Nx.^2.*Nz.^2+dNxdy.*dNxdz.* ...
  Ny.*Nz.^2+(-1).*dNydy.*dNydz.*Ny.*Nz.^2+(-2).*dNxdy.*dNzdx.*Ny.* ...
  Nz.^2+(-4).*dNydy.*dNzdy.*Ny.*Nz.^2+(-2).*dNydz.*dNzdz.*Ny.*Nz.^2+ ...
  (-6).*dNzdy.*dNzdz.*Ny.*Nz.^2+(-2).*d2Nxdydz.*Nx.*Ny.*Nz.^2+(-2).* ...
  d2Nydxdz.*Nx.*Ny.*Nz.^2+(-4).*d2Nzdxdy.*Nx.*Ny.*Nz.^2+(-2).* ...
  d2Nydydz.*Ny.^2.*Nz.^2+(-2).*d2Nzdydy.*Ny.^2.*Nz.^2+(-1).* ...
  d2Nzdzdz.*Ny.^2.*Nz.^2+dNxdz.^2.*Nz.^3+dNydz.^2.*Nz.^3+(-2).* ...
  dNxdz.*dNzdx.*Nz.^3+(-2).*dNydz.*dNzdy.*Nz.^3+(-2).*dNydy.*dNzdz.* ...
  Nz.^3+(-4).*dNzdz.^2.*Nz.^3+(-1).*d2Nxdzdz.*Nx.*Nz.^3+(-4).* ...
  d2Nzdxdz.*Nx.*Nz.^3+(-1).*d2Nydzdz.*Ny.*Nz.^3+(-4).*d2Nzdydz.*Ny.* ...
  Nz.^3+(-2).*d2Nzdzdz.*Nz.^4+(-1).*dNxdx.*((-1).*dNydz.*Nx.^2.*Ny+ ...
  3.*dNzdy.*Nx.^2.*Ny+dNzdy.*Ny.^3+dNydy.*Nx.^2.*Nz+3.*dNzdz.* ...
  Nx.^2.*Nz+2.*dNxdy.*Nx.*Ny.*Nz+2.*dNydx.*Nx.*Ny.*Nz+dNydy.*Ny.^2.* ...
  Nz+dNzdz.*Ny.^2.*Nz+dNydz.*Ny.*Nz.^2+2.*dNzdy.*Ny.*Nz.^2+2.* ...
  dNzdz.*Nz.^3+dNxdz.*Nx.*((-2).*Nx.^2+(-1).*Ny.^2+Nz.^2)+2.*dNzdx.* ...
  Nx.*(2.*Nx.^2+Ny.^2+2.*Nz.^2))+(-1).*dNydx.*((-1).*dNxdz.*Nx.^2.* ...
  Ny+2.*dNzdx.*Nx.^2.*Ny+dNxdy.*Nx.^2.*Nz+2.*dNydy.*Nx.*Ny.*Nz+2.* ...
  dNzdz.*Nx.*Ny.*Nz+dNxdy.*Ny.^2.*Nz+dNxdz.*Ny.*Nz.^2+(-1).*dNydz.* ...
  Nx.*(Nx.^2+2.*Ny.^2+Nz.^2)+dNzdy.*Nx.*(Nx.^2+3.*Ny.^2+2.*Nz.^2)));

%}

%% Q Tensor 

ELx = (-2).*Nx.*(2.*dNxdx.^2+dNxdy.*dNydx+dNxdx.*dNydy+dNxdz.*dNzdx+ ...
  dNxdx.*dNzdz+2.*d2Nxdxdx.*Nx+d2Nydxdy.*Nx+d2Nzdxdz.*Nx)+(-1).*(2.* ...
  dNxdx.*dNydx+2.*dNydx.*dNydy+2.*dNxdy.*(dNxdx+dNydy)+dNydz.*dNzdx+ ...
  dNxdz.*dNzdy+(dNxdy+dNydx).*dNzdz+4.*d2Nxdxdy.*Nx+d2Nydxdx.*Nx+ ...
  d2Nydydy.*Nx+d2Nzdydz.*Nx).*Ny+(-1).*(d2Nxdxdx+d2Nxdydy+2.* ...
  d2Nydxdy+d2Nzdxdz).*Ny.^2+(-1).*(dNxdy.*dNydz+2.*dNxdx.*dNzdx+ ...
  dNydy.*dNzdx+dNydx.*dNzdy+2.*dNzdx.*dNzdz+dNxdz.*(2.*dNxdx+dNydy+ ...
  2.*dNzdz)+(4.*d2Nxdxdz+d2Nydydz+d2Nzdxdx+d2Nzdzdz).*Nx+2.* ...
  d2Nxdydz.*Ny+d2Nydxdz.*Ny+d2Nzdxdy.*Ny).*Nz+(-1).*(d2Nxdxdx+ ...
  d2Nxdzdz+d2Nydxdy+2.*d2Nzdxdz).*Nz.^2+K22.*((-2).*((-1).*d2Nxdxdx+ ...
  d2Nxdydy+d2Nxdzdz+(-1).*d2Nydxdy+(-1).*d2Nzdxdz).*Nx.^2+((-1).* ...
  d2Nxdzdz+2.*d2Nydxdy+d2Nzdxdz).*Ny.^2+Ny.*(2.*dNxdx.*dNxdy+2.* ...
  dNydx.*dNydy+dNydz.*dNzdx+dNxdz.*((-2).*dNydz+dNzdy)+(dNxdy+dNydx) ...
  .*dNzdz+2.*d2Nxdydz.*Nz+d2Nydxdz.*Nz+d2Nzdxdy.*Nz)+Nz.*(dNxdz.*( ...
  2.*dNxdx+dNydy)+dNxdy.*dNydz+dNydy.*dNzdx+(-2).*dNxdy.*dNzdy+ ...
  dNydx.*dNzdy+2.*dNzdx.*dNzdz+(-1).*d2Nxdydy.*Nz+d2Nydxdy.*Nz+2.* ...
  d2Nzdxdz.*Nz)+Nx.*(2.*dNxdx.^2+(-2).*dNxdy.^2+(-2).*dNxdz.^2+2.* ...
  dNxdy.*dNydx+2.*dNxdx.*dNydy+2.*dNxdz.*dNzdx+2.*dNxdx.*dNzdz+(4.* ...
  d2Nxdxdy+(-1).*d2Nydzdz+d2Nzdydz).*Ny+4.*d2Nxdxdz.*Nz+d2Nydydz.* ...
  Nz+(-1).*d2Nzdydy.*Nz))+K33.*((-2).*d2Nxdxdx.*Nx.^4+(-1).* ...
  d2Nxdydy.*Ny.^4+Ny.*Nz.^2.*((-1).*dNxdx.*dNxdy+(-2).*dNxdy.*dNydy+ ...
  dNydx.*dNydy+dNydz.*dNzdx+2.*dNzdx.*dNzdy+(-1).*dNxdz.*(2.*dNydz+ ...
  3.*dNzdy)+((-3).*dNxdy+dNydx).*dNzdz+(-2).*d2Nxdydz.*Nz)+(-1).* ...
  Ny.^3.*((-2).*dNydx.*dNydy+dNxdy.*(dNxdx+4.*dNydy)+dNxdz.*dNzdy+( ...
  -1).*dNzdx.*dNzdy+dNxdy.*dNzdz+2.*d2Nxdydz.*Nz)+(-1).*Nz.^3.*( ...
  dNxdy.*dNydz+(-1).*dNydx.*dNydz+(-2).*dNzdx.*dNzdz+dNxdz.*(dNxdx+ ...
  dNydy+4.*dNzdz)+d2Nxdzdz.*Nz)+(-1).*Ny.^2.*Nz.*(3.*dNxdy.*dNydz+( ...
  -2).*dNydx.*dNydz+(-1).*dNydy.*dNzdx+2.*dNxdy.*dNzdy+(-1).*dNydx.* ...
  dNzdy+(-1).*dNzdx.*dNzdz+dNxdz.*(dNxdx+3.*dNydy+2.*dNzdz)+( ...
  d2Nxdydy+d2Nxdzdz).*Nz)+(-1).*Nx.^3.*(4.*dNxdx.^2+2.*dNxdy.*dNydx+ ...
  (-1).*dNydx.^2+2.*dNxdx.*dNydy+2.*dNxdz.*dNzdx+(-1).*dNzdx.^2+2.* ...
  dNxdx.*dNzdz+4.*d2Nxdxdy.*Ny+d2Nydxdx.*Ny+4.*d2Nxdxdz.*Nz+ ...
  d2Nzdxdx.*Nz)+(-1).*Nx.^2.*(Ny.*(2.*dNxdx.*dNydx+dNydx.*dNydy+ ...
  dNxdy.*(6.*dNxdx+4.*dNydy)+dNydz.*dNzdx+2.*dNxdz.*dNzdy+(-1).* ...
  dNzdx.*dNzdy+(2.*dNxdy+dNydx).*dNzdz+d2Nxdxdx.*Ny+2.*d2Nxdydy.*Ny+ ...
  2.*d2Nydxdy.*Ny)+((2.*dNxdy+(-1).*dNydx).*dNydz+2.*dNxdx.*dNzdx+ ...
  dNydy.*dNzdx+dNydx.*dNzdy+dNzdx.*dNzdz+2.*dNxdz.*(3.*dNxdx+dNydy+ ...
  2.*dNzdz)+4.*d2Nxdydz.*Ny+2.*d2Nydxdz.*Ny+2.*d2Nzdxdy.*Ny).*Nz+( ...
  d2Nxdxdx+2.*d2Nxdzdz+2.*d2Nzdxdz).*Nz.^2)+(-1).*Nx.*(Ny.^2.*( ...
  dNxdx.^2+2.*dNxdy.^2+3.*dNxdy.*dNydx+(-2).*dNydx.^2+3.*dNxdx.* ...
  dNydy+2.*dNydy.^2+dNxdz.*dNzdx+(-1).*dNzdx.^2+dNydz.*dNzdy+(dNxdx+ ...
  dNydy).*dNzdz+2.*d2Nxdxdy.*Ny+d2Nydydy.*Ny)+Ny.*(2.*dNxdz.*(2.* ...
  dNxdy+dNydx)+2.*dNxdy.*dNzdx+(-2).*dNydx.*dNzdx+2.*dNxdx.*dNzdy+ ...
  2.*dNydy.*dNzdy+2.*dNzdy.*dNzdz+2.*dNydz.*(dNxdx+dNydy+dNzdz)+2.* ...
  d2Nxdxdz.*Ny+2.*d2Nydydz.*Ny+d2Nzdydy.*Ny).*Nz+(dNxdx.^2+2.* ...
  dNxdz.^2+dNxdy.*dNydx+(-1).*dNydx.^2+dNxdx.*dNydy+3.*dNxdz.*dNzdx+ ...
  (-2).*dNzdx.^2+dNydz.*dNzdy+(3.*dNxdx+dNydy).*dNzdz+2.*dNzdz.^2+ ...
  2.*d2Nxdxdy.*Ny+d2Nydzdz.*Ny+2.*d2Nzdydz.*Ny).*Nz.^2+(2.*d2Nxdxdz+ ...
  d2Nzdzdz).*Nz.^3))+K11.*(2.*d2Nxdxdx.*Nx.^4+d2Nxdydy.*Ny.^4+ ...
  Ny.^3.*((-2).*dNydx.*dNydy+dNxdy.*(dNxdx+4.*dNydy)+dNxdz.*dNzdy+( ...
  -1).*dNzdx.*dNzdy+dNxdy.*dNzdz+2.*d2Nxdydz.*Nz)+Nx.^3.*(4.* ...
  dNxdx.^2+2.*dNxdy.*dNydx+(-1).*dNydx.^2+2.*dNxdx.*dNydy+2.*dNxdz.* ...
  dNzdx+(-1).*dNzdx.^2+2.*dNxdx.*dNzdz+4.*d2Nxdxdy.*Ny+d2Nydxdx.*Ny+ ...
  4.*d2Nxdxdz.*Nz+d2Nzdxdx.*Nz)+Ny.^2.*((-1).*d2Nxdxdx+(-1).* ...
  d2Nxdydy+(-2).*d2Nydxdy+(-1).*d2Nzdxdz+((3.*dNxdy+(-2).*dNydx).* ...
  dNydz+(-1).*dNydy.*dNzdx+2.*dNxdy.*dNzdy+(-1).*dNydx.*dNzdy+(-1).* ...
  dNzdx.*dNzdz+dNxdz.*(dNxdx+3.*dNydy+2.*dNzdz)).*Nz+(d2Nxdydy+ ...
  d2Nxdzdz).*Nz.^2)+Nx.^2.*((-2).*(2.*d2Nxdxdx+d2Nydxdy+d2Nzdxdz)+( ...
  2.*dNxdx.*dNydx+dNydx.*dNydy+dNxdy.*(6.*dNxdx+4.*dNydy)+dNydz.* ...
  dNzdx+2.*dNxdz.*dNzdy+(-1).*dNzdx.*dNzdy+(2.*dNxdy+dNydx).*dNzdz) ...
  .*Ny+(d2Nxdxdx+2.*d2Nxdydy+2.*d2Nydxdy).*Ny.^2+((2.*dNxdy+(-1).* ...
  dNydx).*dNydz+2.*dNxdx.*dNzdx+dNydy.*dNzdx+dNydx.*dNzdy+dNzdx.* ...
  dNzdz+2.*dNxdz.*(3.*dNxdx+dNydy+2.*dNzdz)+4.*d2Nxdydz.*Ny+2.* ...
  d2Nydxdz.*Ny+2.*d2Nzdxdy.*Ny).*Nz+(d2Nxdxdx+2.*d2Nxdzdz+2.* ...
  d2Nzdxdz).*Nz.^2)+Ny.*((-2).*dNxdx.*dNxdy+(-2).*dNxdx.*dNydx+(-2) ...
  .*dNxdy.*dNydy+(-2).*dNydx.*dNydy+(-1).*dNydz.*dNzdx+(-1).*dNxdz.* ...
  dNzdy+(-1).*(dNxdy+dNydx).*dNzdz+(-1).*(2.*d2Nxdydz+d2Nydxdz+ ...
  d2Nzdxdy).*Nz+(dNxdx.*dNxdy+2.*dNxdy.*dNydy+(-1).*dNydx.*dNydy+( ...
  -1).*dNydz.*dNzdx+(-2).*dNzdx.*dNzdy+dNxdz.*(2.*dNydz+3.*dNzdy)+( ...
  3.*dNxdy+(-1).*dNydx).*dNzdz).*Nz.^2+2.*d2Nxdydz.*Nz.^3)+Nx.*((-2) ...
  .*(2.*dNxdx.^2+dNxdy.*dNydx+dNxdx.*dNydy+dNxdz.*dNzdx+dNxdx.* ...
  dNzdz)+(-1).*(4.*d2Nxdxdy+d2Nydxdx+d2Nydydy+d2Nzdydz).*Ny+( ...
  dNxdx.^2+2.*dNxdy.^2+3.*dNxdy.*dNydx+(-2).*dNydx.^2+3.*dNxdx.* ...
  dNydy+2.*dNydy.^2+dNxdz.*dNzdx+(-1).*dNzdx.^2+dNydz.*dNzdy+(dNxdx+ ...
  dNydy).*dNzdz).*Ny.^2+(2.*d2Nxdxdy+d2Nydydy).*Ny.^3+((-4).* ...
  d2Nxdxdz+(-1).*d2Nydydz+(-1).*d2Nzdxdx+(-1).*d2Nzdzdz+2.*(dNxdz.*( ...
  2.*dNxdy+dNydx)+dNxdy.*dNzdx+(-1).*dNydx.*dNzdx+dNxdx.*dNzdy+ ...
  dNydy.*dNzdy+dNzdy.*dNzdz+dNydz.*(dNxdx+dNydy+dNzdz)).*Ny+(2.* ...
  d2Nxdxdz+2.*d2Nydydz+d2Nzdydy).*Ny.^2).*Nz+(dNxdx.^2+2.*dNxdz.^2+ ...
  dNxdy.*dNydx+(-1).*dNydx.^2+dNxdx.*dNydy+3.*dNxdz.*dNzdx+(-2).* ...
  dNzdx.^2+dNydz.*dNzdy+(3.*dNxdx+dNydy).*dNzdz+2.*dNzdz.^2+2.* ...
  d2Nxdxdy.*Ny+d2Nydzdz.*Ny+2.*d2Nzdydz.*Ny).*Nz.^2+(2.*d2Nxdxdz+ ...
  d2Nzdzdz).*Nz.^3)+Nz.*((-1).*dNxdy.*dNydz+(-2).*dNxdx.*dNzdx+(-1) ...
  .*dNydy.*dNzdx+(-1).*dNydx.*dNzdy+(-2).*dNzdx.*dNzdz+(-1).*( ...
  d2Nxdxdx+d2Nxdzdz+d2Nydxdy+2.*d2Nzdxdz).*Nz+((dNxdy+(-1).*dNydx).* ...
  dNydz+(-2).*dNzdx.*dNzdz).*Nz.^2+d2Nxdzdz.*Nz.^3+dNxdz.*(dNxdx.*(( ...
  -2)+Nz.^2)+dNydy.*((-1)+Nz.^2)+dNzdz.*((-2)+4.*Nz.^2))));

ELy = (-1).*(2.*d2Nxdxdy+d2Nydxdx+d2Nydydy+d2Nzdydz).*Nx.^2+(-1).*Nx.*( ...
  2.*dNxdx.*dNydx+2.*dNydx.*dNydy+2.*dNxdy.*(dNxdx+dNydy)+dNydz.* ...
  dNzdx+dNxdz.*dNzdy+(dNxdy+dNydx).*dNzdz+d2Nxdxdx.*Ny+d2Nxdydy.*Ny+ ...
  4.*d2Nydxdy.*Ny+d2Nzdxdz.*Ny)+(-2).*Ny.*(dNxdy.*dNydx+dNxdx.* ...
  dNydy+2.*dNydy.^2+dNydz.*dNzdy+dNydy.*dNzdz+d2Nxdxdy.*Ny+2.* ...
  d2Nydydy.*Ny+d2Nzdydz.*Ny)+(-1).*(dNxdz.*dNydx+dNxdy.*dNzdx+ ...
  dNxdx.*dNzdy+2.*dNydy.*dNzdy+2.*dNzdy.*dNzdz+dNydz.*(dNxdx+2.* ...
  dNydy+2.*dNzdz)+d2Nxdydz.*Nx+2.*d2Nydxdz.*Nx+d2Nzdxdy.*Nx+( ...
  d2Nxdxdz+4.*d2Nydydz+d2Nzdydy+d2Nzdzdz).*Ny).*Nz+(-1).*(d2Nxdxdy+ ...
  d2Nydydy+d2Nydzdz+2.*d2Nzdydz).*Nz.^2+K22.*((2.*d2Nxdxdy+(-1).* ...
  d2Nydzdz+d2Nzdydz).*Nx.^2+(-2).*((-1).*d2Nxdxdy+d2Nydxdx+(-1).* ...
  d2Nydydy+d2Nydzdz+(-1).*d2Nzdydz).*Ny.^2+Ny.*(2.*dNxdy.*dNydx+(-2) ...
  .*dNydx.^2+2.*dNxdx.*dNydy+2.*dNydy.^2+(-2).*dNydz.^2+2.*dNydz.* ...
  dNzdy+2.*dNydy.*dNzdz+d2Nxdxdz.*Nz+4.*d2Nydydz.*Nz+(-1).* ...
  d2Nzdxdx.*Nz)+Nx.*(2.*dNxdx.*dNxdy+2.*dNydx.*dNydy+dNydz.*dNzdx+ ...
  dNxdz.*((-2).*dNydz+dNzdy)+dNxdy.*dNzdz+dNydx.*dNzdz+((-1).* ...
  d2Nxdzdz+4.*d2Nydxdy+d2Nzdxdz).*Ny+d2Nxdydz.*Nz+2.*d2Nydxdz.*Nz+ ...
  d2Nzdxdy.*Nz)+Nz.*(dNxdz.*dNydx+(dNxdx+2.*dNydy).*dNydz+dNxdy.* ...
  dNzdx+(-2).*dNydx.*dNzdx+dNxdx.*dNzdy+2.*dNzdy.*dNzdz+d2Nxdxdy.* ...
  Nz+(-1).*d2Nydxdx.*Nz+2.*d2Nzdydz.*Nz))+K33.*((-1).*d2Nydxdx.* ...
  Nx.^4+(-2).*d2Nydydy.*Ny.^4+Nx.^3.*(2.*dNxdx.*dNxdy+(-4).*dNxdx.* ...
  dNydx+(-1).*dNydx.*dNydy+(-1).*dNydz.*dNzdx+dNzdx.*dNzdy+(-1).* ...
  dNydx.*dNzdz+(-1).*d2Nxdxdx.*Ny+(-2).*d2Nydxdy.*Ny+(-2).* ...
  d2Nydxdz.*Nz)+(-1).*Nz.^3.*((-1).*dNxdy.*dNxdz+dNxdz.*dNydx+(-2).* ...
  dNzdy.*dNzdz+dNydz.*(dNxdx+dNydy+4.*dNzdz)+d2Nydzdz.*Nz)+Ny.^3.*( ...
  dNxdy.^2+(-2).*dNxdy.*dNydx+(-2).*dNxdx.*dNydy+(-4).*dNydy.^2+(-2) ...
  .*dNydz.*dNzdy+dNzdy.^2+(-2).*dNydy.*dNzdz+(-4).*d2Nydydz.*Nz+(-1) ...
  .*d2Nzdydy.*Nz)+(-1).*Ny.^2.*Nz.*((-1).*dNxdy.*dNxdz+2.*dNxdz.* ...
  dNydx+dNxdy.*dNzdx+dNxdx.*dNzdy+2.*dNydy.*dNzdy+dNzdy.*dNzdz+2.* ...
  dNydz.*(dNxdx+3.*dNydy+2.*dNzdz)+(d2Nydydy+2.*d2Nydzdz+2.* ...
  d2Nzdydz).*Nz)+(-1).*Ny.*Nz.^2.*((-1).*dNxdy.^2+dNxdy.*dNydx+ ...
  dNxdx.*dNydy+dNydy.^2+2.*dNydz.^2+dNxdz.*dNzdx+3.*dNydz.*dNzdy+( ...
  -2).*dNzdy.^2+(dNxdx+3.*dNydy).*dNzdz+2.*dNzdz.^2+2.*d2Nydydz.*Nz+ ...
  d2Nzdzdz.*Nz)+(-1).*Nx.^2.*(Ny.*(2.*dNxdx.^2+(-2).*dNxdy.^2+3.* ...
  dNxdy.*dNydx+2.*dNydx.^2+3.*dNxdx.*dNydy+dNydy.^2+dNxdz.*dNzdx+ ...
  dNydz.*dNzdy+(-1).*dNzdy.^2+(dNxdx+dNydy).*dNzdz+2.*d2Nxdxdy.*Ny+ ...
  2.*d2Nydxdx.*Ny+d2Nydydy.*Ny)+(dNxdz.*((-2).*dNxdy+3.*dNydx)+(-1) ...
  .*dNxdy.*dNzdx+2.*dNydx.*dNzdx+(-1).*dNxdx.*dNzdy+(-1).*dNzdy.* ...
  dNzdz+dNydz.*(3.*dNxdx+dNydy+2.*dNzdz)+2.*d2Nxdxdz.*Ny+2.* ...
  d2Nydydz.*Ny+d2Nzdxdx.*Ny).*Nz+(d2Nydxdx+d2Nydzdz).*Nz.^2)+(-1).* ...
  Nx.*(Ny.^2.*(4.*dNxdx.*dNydx+6.*dNydx.*dNydy+dNxdy.*(dNxdx+2.* ...
  dNydy)+2.*dNydz.*dNzdx+dNxdz.*dNzdy+(-1).*dNzdx.*dNzdy+(dNxdy+2.* ...
  dNydx).*dNzdz+d2Nxdydy.*Ny+4.*d2Nydxdy.*Ny)+2.*Ny.*((dNxdy+2.* ...
  dNydx).*dNydz+dNxdx.*dNzdx+dNydy.*dNzdx+(-1).*dNxdy.*dNzdy+dNydx.* ...
  dNzdy+dNzdx.*dNzdz+dNxdz.*(dNxdx+dNydy+dNzdz)+d2Nxdydz.*Ny+2.* ...
  d2Nydxdz.*Ny+d2Nzdxdy.*Ny).*Nz+((-1).*dNxdx.*dNxdy+2.*dNxdx.* ...
  dNydx+dNydx.*dNydy+3.*dNydz.*dNzdx+dNxdz.*(2.*dNydz+(-1).*dNzdy)+( ...
  -2).*dNzdx.*dNzdy+(-1).*dNxdy.*dNzdz+3.*dNydx.*dNzdz+(d2Nxdzdz+2.* ...
  (d2Nydxdy+d2Nzdxdz)).*Ny).*Nz.^2+2.*d2Nydxdz.*Nz.^3))+K11.*( ...
  d2Nydxdx.*Nx.^4+2.*d2Nydydy.*Ny.^4+Nx.^3.*((-2).*dNxdx.*dNxdy+4.* ...
  dNxdx.*dNydx+dNydx.*dNydy+dNydz.*dNzdx+(-1).*dNzdx.*dNzdy+dNydx.* ...
  dNzdz+d2Nxdxdx.*Ny+2.*d2Nydxdy.*Ny+2.*d2Nydxdz.*Nz)+Ny.^3.*((-1).* ...
  dNxdy.^2+2.*dNxdy.*dNydx+2.*dNxdx.*dNydy+4.*dNydy.^2+2.*dNydz.* ...
  dNzdy+(-1).*dNzdy.^2+2.*dNydy.*dNzdz+4.*d2Nydydz.*Nz+d2Nzdydy.*Nz) ...
  +Nx.^2.*((-2).*d2Nxdxdy+(-1).*d2Nydxdx+(-1).*d2Nydydy+(-1).* ...
  d2Nzdydz+(2.*dNxdx.^2+(-2).*dNxdy.^2+3.*dNxdy.*dNydx+2.*dNydx.^2+ ...
  3.*dNxdx.*dNydy+dNydy.^2+dNxdz.*dNzdx+dNydz.*dNzdy+(-1).*dNzdy.^2+ ...
  (dNxdx+dNydy).*dNzdz).*Ny+(2.*(d2Nxdxdy+d2Nydxdx)+d2Nydydy).* ...
  Ny.^2+(dNxdz.*((-2).*dNxdy+3.*dNydx)+(-1).*dNxdy.*dNzdx+2.*dNydx.* ...
  dNzdx+(-1).*dNxdx.*dNzdy+(-1).*dNzdy.*dNzdz+dNydz.*(3.*dNxdx+ ...
  dNydy+2.*dNzdz)+2.*d2Nxdxdz.*Ny+2.*d2Nydydz.*Ny+d2Nzdxdx.*Ny).*Nz+ ...
  (d2Nydxdx+d2Nydzdz).*Nz.^2)+Ny.^2.*((-2).*(d2Nxdxdy+2.*d2Nydydy+ ...
  d2Nzdydz)+((-1).*dNxdz.*(dNxdy+(-2).*dNydx)+dNxdy.*dNzdx+dNxdx.* ...
  dNzdy+2.*dNydy.*dNzdy+dNzdy.*dNzdz+2.*dNydz.*(dNxdx+3.*dNydy+2.* ...
  dNzdz)).*Nz+(d2Nydydy+2.*d2Nydzdz+2.*d2Nzdydz).*Nz.^2)+Nx.*((-2).* ...
  dNxdx.*dNxdy+(-2).*dNxdx.*dNydx+(-2).*dNxdy.*dNydy+(-2).*dNydx.* ...
  dNydy+(-1).*dNydz.*dNzdx+(-1).*dNxdz.*dNzdy+(-1).*d2Nxdxdx.*Ny+( ...
  -1).*d2Nxdydy.*Ny+(-4).*d2Nydxdy.*Ny+(-1).*d2Nzdxdz.*Ny+dNxdx.* ...
  dNxdy.*Ny.^2+4.*dNxdx.*dNydx.*Ny.^2+2.*dNxdy.*dNydy.*Ny.^2+6.* ...
  dNydx.*dNydy.*Ny.^2+2.*dNydz.*dNzdx.*Ny.^2+dNxdz.*dNzdy.*Ny.^2+( ...
  -1).*dNzdx.*dNzdy.*Ny.^2+d2Nxdydy.*Ny.^3+4.*d2Nydxdy.*Ny.^3+ ...
  dNzdz.*(dNxdy.*((-1)+Ny.^2)+dNydx.*((-1)+2.*Ny.^2))+((-1).* ...
  d2Nxdydz+(-2).*d2Nydxdz+(-1).*d2Nzdxdy+2.*((dNxdy+2.*dNydx).* ...
  dNydz+dNxdx.*dNzdx+dNydy.*dNzdx+(-1).*dNxdy.*dNzdy+dNydx.*dNzdy+ ...
  dNzdx.*dNzdz+dNxdz.*(dNxdx+dNydy+dNzdz)).*Ny+2.*(d2Nxdydz+2.* ...
  d2Nydxdz+d2Nzdxdy).*Ny.^2).*Nz+((-1).*dNxdx.*dNxdy+2.*dNxdx.* ...
  dNydx+dNydx.*dNydy+3.*dNydz.*dNzdx+dNxdz.*(2.*dNydz+(-1).*dNzdy)+( ...
  -2).*dNzdx.*dNzdy+(-1).*dNxdy.*dNzdz+3.*dNydx.*dNzdz+(d2Nxdzdz+2.* ...
  (d2Nydxdy+d2Nzdxdz)).*Ny).*Nz.^2+2.*d2Nydxdz.*Nz.^3)+Ny.*((-2).*( ...
  dNxdy.*dNydx+dNxdx.*dNydy+2.*dNydy.^2+dNydz.*dNzdy+dNydy.*dNzdz)+( ...
  -1).*(d2Nxdxdz+4.*d2Nydydz+d2Nzdydy+d2Nzdzdz).*Nz+((-1).*dNxdy.^2+ ...
  dNxdy.*dNydx+dNxdx.*dNydy+dNydy.^2+2.*dNydz.^2+dNxdz.*dNzdx+3.* ...
  dNydz.*dNzdy+(-2).*dNzdy.^2+(dNxdx+3.*dNydy).*dNzdz+2.*dNzdz.^2).* ...
  Nz.^2+(2.*d2Nydydz+d2Nzdzdz).*Nz.^3)+Nz.*((-1).*dNxdz.*dNydx+(-1) ...
  .*dNxdy.*dNzdx+(-1).*dNxdx.*dNzdy+(-2).*dNydy.*dNzdy+(-2).*dNzdy.* ...
  dNzdz+(-1).*(d2Nxdxdy+d2Nydydy+d2Nydzdz+2.*d2Nzdydz).*Nz+(dNxdz.*( ...
  (-1).*dNxdy+dNydx)+(-2).*dNzdy.*dNzdz).*Nz.^2+d2Nydzdz.*Nz.^3+ ...
  dNydz.*(dNydy.*((-2)+Nz.^2)+dNxdx.*((-1)+Nz.^2)+dNzdz.*((-2)+4.* ...
  Nz.^2))));


ELz = (-1).*(2.*d2Nxdxdz+d2Nydydz+d2Nzdxdx+d2Nzdzdz).*Nx.^2+(-1).*( ...
  d2Nxdxdz+2.*d2Nydydz+d2Nzdydy+d2Nzdzdz).*Ny.^2+(-1).*Nx.*(dNxdy.* ...
  dNydz+2.*dNxdx.*dNzdx+dNydy.*dNzdx+dNydx.*dNzdy+2.*dNzdx.*dNzdz+ ...
  dNxdz.*(2.*dNxdx+dNydy+2.*dNzdz)+d2Nxdydz.*Ny+d2Nydxdz.*Ny+2.* ...
  d2Nzdxdy.*Ny+(d2Nxdxdx+d2Nxdzdz+d2Nydxdy+4.*d2Nzdxdz).*Nz)+(-1).* ...
  Ny.*(dNxdz.*dNydx+dNxdy.*dNzdx+dNxdx.*dNzdy+2.*dNydy.*dNzdy+2.* ...
  dNzdy.*dNzdz+dNydz.*(dNxdx+2.*dNydy+2.*dNzdz)+(d2Nxdxdy+d2Nydydy+ ...
  d2Nydzdz+4.*d2Nzdydz).*Nz)+(-2).*Nz.*(dNxdz.*dNzdx+dNydz.*dNzdy+( ...
  dNxdx+dNydy).*dNzdz+2.*dNzdz.^2+(d2Nxdxdz+d2Nydydz+2.*d2Nzdzdz).* ...
  Nz)+K22.*((2.*d2Nxdxdz+d2Nydydz+(-1).*d2Nzdydy).*Nx.^2+Ny.*( ...
  dNxdz.*dNydx+(dNxdx+2.*dNydy).*dNydz+dNxdy.*dNzdx+(-2).*dNydx.* ...
  dNzdx+dNxdx.*dNzdy+2.*dNzdy.*dNzdz+d2Nxdxdz.*Ny+2.*d2Nydydz.*Ny+( ...
  -1).*d2Nzdxdx.*Ny)+Nx.*(dNxdz.*(2.*dNxdx+dNydy)+dNxdy.*dNydz+ ...
  dNydy.*dNzdx+(-2).*dNxdy.*dNzdy+dNydx.*dNzdy+2.*dNzdx.*dNzdz+ ...
  d2Nxdydz.*Ny+d2Nydxdz.*Ny+2.*d2Nzdxdy.*Ny)+(2.*dNxdz.*dNzdx+(-2).* ...
  dNzdx.^2+2.*dNydz.*dNzdy+(-2).*dNzdy.^2+2.*(dNxdx+dNydy).*dNzdz+ ...
  2.*dNzdz.^2+(-1).*d2Nxdydy.*Nx+d2Nydxdy.*Nx+4.*d2Nzdxdz.*Nx+ ...
  d2Nxdxdy.*Ny+(-1).*d2Nydxdx.*Ny+4.*d2Nzdydz.*Ny).*Nz+2.*(d2Nxdxdz+ ...
  d2Nydydz+(-1).*d2Nzdxdx+(-1).*d2Nzdydy+d2Nzdzdz).*Nz.^2)+K33.*(( ...
  -1).*d2Nzdxdx.*Nx.^4+(-1).*d2Nzdydy.*Ny.^4+Nx.^3.*(2.*dNxdx.* ...
  dNxdz+dNydx.*dNydz+(-4).*dNxdx.*dNzdx+(-1).*dNydy.*dNzdx+(-1).* ...
  dNydx.*dNzdy+(-1).*dNzdx.*dNzdz+(-2).*d2Nzdxdy.*Ny+(-1).* ...
  d2Nxdxdx.*Nz+(-2).*d2Nzdxdz.*Nz)+Ny.^3.*(dNxdy.*dNxdz+2.*dNydy.* ...
  dNydz+(-1).*dNxdy.*dNzdx+(-1).*dNxdx.*dNzdy+(-4).*dNydy.*dNzdy+( ...
  -1).*dNzdy.*dNzdz+(-1).*d2Nydydy.*Nz+(-2).*d2Nzdydz.*Nz)+(-1).* ...
  Ny.*Nz.^2.*((-1).*dNxdy.*dNxdz+dNxdz.*dNydx+2.*dNxdy.*dNzdx+2.* ...
  dNxdx.*dNzdy+4.*dNydy.*dNzdy+6.*dNzdy.*dNzdz+dNydz.*(dNxdx+dNydy+ ...
  2.*dNzdz)+(d2Nydzdz+4.*d2Nzdydz).*Nz)+(-1).*Ny.^2.*Nz.*((-1).* ...
  dNxdz.^2+dNxdy.*dNydx+dNxdx.*dNydy+2.*dNydy.^2+(-2).*dNydz.^2+ ...
  dNxdz.*dNzdx+3.*dNydz.*dNzdy+2.*dNzdy.^2+dNxdx.*dNzdz+3.*dNydy.* ...
  dNzdz+dNzdz.^2+2.*d2Nydydz.*Nz+2.*d2Nzdydy.*Nz+d2Nzdzdz.*Nz)+(-1) ...
  .*Nx.^2.*(Ny.*((-1).*dNxdz.*(2.*dNxdy+dNydx)+(-1).*(dNxdx+dNydy).* ...
  dNydz+3.*dNxdy.*dNzdx+2.*dNydx.*dNzdx+3.*dNxdx.*dNzdy+2.*dNydy.* ...
  dNzdy+dNzdy.*dNzdz+d2Nzdxdx.*Ny+d2Nzdydy.*Ny)+(2.*dNxdx.^2+(-2).* ...
  dNxdz.^2+dNxdy.*dNydx+dNxdx.*dNydy+(-1).*dNydz.^2+3.*dNxdz.*dNzdx+ ...
  2.*dNzdx.^2+dNydz.*dNzdy+3.*dNxdx.*dNzdz+dNydy.*dNzdz+dNzdz.^2+2.* ...
  d2Nxdxdy.*Ny+d2Nydxdx.*Ny+2.*d2Nzdydz.*Ny).*Nz+(2.*(d2Nxdxdz+ ...
  d2Nzdxdx)+d2Nzdzdz).*Nz.^2)+(-1).*Nx.*(2.*d2Nzdxdy.*Ny.^3+2.*Ny.* ...
  Nz.*(dNxdx.*dNxdy+dNxdx.*dNydx+dNxdy.*dNydy+dNydx.*dNydy+dNydz.* ...
  dNzdx+2.*dNzdx.*dNzdy+dNxdz.*((-1).*dNydz+dNzdy)+(dNxdy+dNydx).* ...
  dNzdz+d2Nxdydz.*Nz+d2Nydxdz.*Nz+2.*d2Nzdxdy.*Nz)+Ny.^2.*((-1).* ...
  dNxdz.*(dNxdx+dNydy)+(-1).*(dNxdy+2.*dNydx).*dNydz+2.*dNxdx.* ...
  dNzdx+3.*dNydy.*dNzdx+2.*dNxdy.*dNzdy+3.*dNydx.*dNzdy+dNzdx.* ...
  dNzdz+d2Nxdydy.*Nz+2.*d2Nydxdy.*Nz+2.*d2Nzdxdz.*Nz)+Nz.^2.*( ...
  dNxdy.*dNydz+(-1).*dNydx.*dNydz+4.*dNxdx.*dNzdx+2.*dNydy.*dNzdx+ ...
  2.*dNydx.*dNzdy+6.*dNzdx.*dNzdz+dNxdz.*(dNxdx+dNydy+2.*dNzdz)+( ...
  d2Nxdzdz+4.*d2Nzdxdz).*Nz))+Nz.^3.*(dNxdz.^2+dNydz.^2+(-2).* ...
  dNxdz.*dNzdx+(-2).*dNydz.*dNzdy+(-2).*((dNxdx+dNydy).*dNzdz+2.* ...
  dNzdz.^2+d2Nzdzdz.*Nz)))+K11.*(d2Nzdxdx.*Nx.^4+d2Nzdydy.*Ny.^4+ ...
  Nx.^3.*((-2).*dNxdx.*dNxdz+(-1).*dNydx.*dNydz+4.*dNxdx.*dNzdx+ ...
  dNydy.*dNzdx+dNydx.*dNzdy+dNzdx.*dNzdz+2.*d2Nzdxdy.*Ny+d2Nxdxdx.* ...
  Nz+2.*d2Nzdxdz.*Nz)+Ny.^3.*((-1).*dNxdy.*dNxdz+(-2).*dNydy.*dNydz+ ...
  dNxdy.*dNzdx+dNxdx.*dNzdy+4.*dNydy.*dNzdy+dNzdy.*dNzdz+d2Nydydy.* ...
  Nz+2.*d2Nzdydz.*Nz)+Nx.^2.*((-2).*d2Nxdxdz+(-1).*d2Nydydz+(-1).* ...
  d2Nzdxdx+(-1).*d2Nzdzdz+(-2).*dNxdy.*dNxdz.*Ny+(-1).*dNxdz.* ...
  dNydx.*Ny+(-1).*dNxdx.*dNydz.*Ny+(-1).*dNydy.*dNydz.*Ny+3.*dNxdy.* ...
  dNzdx.*Ny+2.*dNydx.*dNzdx.*Ny+3.*dNxdx.*dNzdy.*Ny+2.*dNydy.* ...
  dNzdy.*Ny+dNzdy.*dNzdz.*Ny+d2Nzdxdx.*Ny.^2+d2Nzdydy.*Ny.^2+(2.* ...
  dNxdx.^2+(-2).*dNxdz.^2+dNxdy.*dNydx+dNxdx.*dNydy+(-1).*dNydz.^2+ ...
  3.*dNxdz.*dNzdx+2.*dNzdx.^2+dNydz.*dNzdy+3.*dNxdx.*dNzdz+dNydy.* ...
  dNzdz+dNzdz.^2+2.*d2Nxdxdy.*Ny+d2Nydxdx.*Ny+2.*d2Nzdydz.*Ny).*Nz+( ...
  2.*(d2Nxdxdz+d2Nzdxdx)+d2Nzdzdz).*Nz.^2)+Ny.^2.*((-1).*d2Nxdxdz+( ...
  -2).*d2Nydydz+(-1).*d2Nzdydy+(-1).*d2Nzdzdz+((-1).*dNxdz.^2+ ...
  dNxdy.*dNydx+dNxdx.*dNydy+2.*dNydy.^2+(-2).*dNydz.^2+dNxdz.*dNzdx+ ...
  3.*dNydz.*dNzdy+2.*dNzdy.^2+dNxdx.*dNzdz+3.*dNydy.*dNzdz+dNzdz.^2) ...
  .*Nz+(2.*(d2Nydydz+d2Nzdydy)+d2Nzdzdz).*Nz.^2)+Nz.*((-2).*(dNxdz.* ...
  dNzdx+dNydz.*dNzdy+(dNxdx+dNydy).*dNzdz+2.*dNzdz.^2)+(-2).*( ...
  d2Nxdxdz+d2Nydydz+2.*d2Nzdzdz).*Nz+((-1).*dNxdz.^2+(-1).*dNydz.^2+ ...
  2.*dNxdz.*dNzdx+2.*dNydz.*dNzdy+2.*dNzdz.*(dNxdx+dNydy+2.*dNzdz)) ...
  .*Nz.^2+2.*d2Nzdzdz.*Nz.^3)+Ny.*((-1).*dNxdz.*dNydx+(-1).*dNxdy.* ...
  dNzdx+(-1).*dNxdx.*dNzdy+(-2).*dNydy.*dNzdy+(-2).*dNzdy.*dNzdz+( ...
  -1).*(d2Nxdxdy+d2Nydydy+d2Nydzdz+4.*d2Nzdydz).*Nz+(dNxdz.*((-1).* ...
  dNxdy+dNydx)+2.*(dNxdy.*dNzdx+dNxdx.*dNzdy+2.*dNydy.*dNzdy+3.* ...
  dNzdy.*dNzdz)).*Nz.^2+(d2Nydzdz+4.*d2Nzdydz).*Nz.^3+dNydz.*( ...
  dNydy.*((-2)+Nz.^2)+dNxdx.*((-1)+Nz.^2)+2.*dNzdz.*((-1)+Nz.^2)))+ ...
  Nx.*((-1).*dNxdy.*dNydz+(-2).*dNxdx.*dNzdx+(-1).*dNydy.*dNzdx+(-1) ...
  .*dNydx.*dNzdy+(-2).*dNzdx.*dNzdz+2.*d2Nzdxdy.*Ny.^3+(-1).* ...
  d2Nxdxdx.*Nz+(-1).*d2Nxdzdz.*Nz+(-1).*d2Nydxdy.*Nz+(-4).* ...
  d2Nzdxdz.*Nz+dNxdy.*dNydz.*Nz.^2+(-1).*dNydx.*dNydz.*Nz.^2+4.* ...
  dNxdx.*dNzdx.*Nz.^2+2.*dNydy.*dNzdx.*Nz.^2+2.*dNydx.*dNzdy.*Nz.^2+ ...
  6.*dNzdx.*dNzdz.*Nz.^2+d2Nxdzdz.*Nz.^3+4.*d2Nzdxdz.*Nz.^3+Ny.^2.*( ...
  (-1).*dNxdz.*(dNxdx+dNydy)+(-1).*(dNxdy+2.*dNydx).*dNydz+2.* ...
  dNxdx.*dNzdx+3.*dNydy.*dNzdx+2.*dNxdy.*dNzdy+3.*dNydx.*dNzdy+ ...
  dNzdx.*dNzdz+d2Nxdydy.*Nz+2.*d2Nydxdy.*Nz+2.*d2Nzdxdz.*Nz)+Ny.*(( ...
  -1).*d2Nxdydz+(-1).*d2Nydxdz+(-2).*d2Nzdxdy+2.*(dNxdx.*dNxdy+ ...
  dNxdx.*dNydx+dNxdy.*dNydy+dNydx.*dNydy+dNydz.*dNzdx+2.*dNzdx.* ...
  dNzdy+dNxdz.*((-1).*dNydz+dNzdy)+(dNxdy+dNydx).*dNzdz).*Nz+2.*( ...
  d2Nxdydz+d2Nydxdz+2.*d2Nzdxdy).*Nz.^2)+dNxdz.*(dNxdx.*((-2)+Nz.^2) ...
  +dNydy.*((-1)+Nz.^2)+2.*dNzdz.*((-1)+Nz.^2))));


%{
ELx = (1/4).*K11.*(2.*d2\[Phi]dydz.*cos(\[Phi])+(-2).*d\[Phi]dx.*d\[Phi]dz.*cos(\[Phi])+(-2).* ...
  d2\[Phi]dydz.*cos(\[Theta]).^2.*cos(\[Phi])+2.*d\[Phi]dx.*d\[Phi]dz.*cos(\[Theta]).^2.*cos(\[Phi])+(-4).* ...
  d2\[Theta]dxdx.*cos(\[Theta]).^2.*cos(\[Phi]).^2+(-4).*d\[Theta]dy.*d\[Phi]dx.*cos(\[Theta]).^2.*cos(\[Phi]) ...
  .^2+(-4).*d\[Theta]dx.*d\[Phi]dy.*cos(\[Theta]).^2.*cos(\[Phi]).^2+(-4).*d2\[Theta]dzdz.*sin(\[Theta]) ...
  .^2+2.*d2\[Phi]dydz.*cos(\[Phi]).*sin(\[Theta]).^2+(-2).*d\[Phi]dx.*d\[Phi]dz.*cos(\[Phi]).*sin(\[Theta]) ...
  .^2+(-2).*d\[Theta]dz.^2.*sin(2.*\[Theta])+4.*d2\[Theta]dxdz.*cos(\[Phi]).*sin(2.*\[Theta])+2.* ...
  d\[Theta]dy.*d\[Phi]dz.*cos(\[Phi]).*sin(2.*\[Theta])+(-2).*d2\[Phi]dxdy.*cos(\[Phi]).^2.*sin(2.*\[Theta])+ ...
  2.*d\[Theta]dx.^2.*cos(\[Phi]).^2.*sin(2.*\[Theta])+2.*d\[Phi]dx.^2.*cos(\[Phi]).^2.*sin(2.*\[Theta])+ ...
  (-2).*d2\[Phi]dxdz.*sin(\[Phi])+(-2).*d\[Phi]dy.*d\[Phi]dz.*sin(\[Phi])+2.*d2\[Phi]dxdz.*cos(\[Theta]) ...
  .^2.*sin(\[Phi])+2.*d\[Phi]dy.*d\[Phi]dz.*cos(\[Theta]).^2.*sin(\[Phi])+(-2).*d2\[Phi]dxdz.*sin(\[Theta]) ...
  .^2.*sin(\[Phi])+(-2).*d\[Phi]dy.*d\[Phi]dz.*sin(\[Theta]).^2.*sin(\[Phi])+4.*d2\[Theta]dydz.*sin( ...
  2.*\[Theta]).*sin(\[Phi])+(-2).*d\[Theta]dx.*d\[Phi]dz.*sin(2.*\[Theta]).*sin(\[Phi])+(-4).*d2\[Theta]dydy.* ...
  cos(\[Theta]).^2.*sin(\[Phi]).^2+4.*d\[Theta]dy.*d\[Phi]dx.*cos(\[Theta]).^2.*sin(\[Phi]).^2+4.*d\[Theta]dx.* ...
  d\[Phi]dy.*cos(\[Theta]).^2.*sin(\[Phi]).^2+2.*d2\[Phi]dxdy.*sin(2.*\[Theta]).*sin(\[Phi]).^2+2.* ...
  d\[Theta]dy.^2.*sin(2.*\[Theta]).*sin(\[Phi]).^2+2.*d\[Phi]dy.^2.*sin(2.*\[Theta]).*sin(\[Phi]).^2+2.* ...
  d\[Theta]dz.*(2.*d\[Theta]dx.*cos(\[Theta]).^2.*cos(\[Phi])+(-2).*d\[Theta]dx.*cos(\[Phi]).*sin(\[Theta]).^2+ ...
  d\[Phi]dy.*cos(\[Phi]).*sin(2.*\[Theta])+2.*d\[Theta]dy.*cos(2.*\[Theta]).*sin(\[Phi])+(-1).*d\[Phi]dx.* ...
  sin(2.*\[Theta]).*sin(\[Phi]))+(-4).*d2\[Theta]dxdy.*cos(\[Theta]).^2.*sin(2.*\[Phi])+4.*d\[Theta]dx.* ...
  d\[Phi]dx.*cos(\[Theta]).^2.*sin(2.*\[Phi])+(-4).*d\[Theta]dy.*d\[Phi]dy.*cos(\[Theta]).^2.*sin(2.*\[Phi])+ ...
  d2\[Phi]dxdx.*sin(2.*\[Theta]).*sin(2.*\[Phi])+(-1).*d2\[Phi]dydy.*sin(2.*\[Theta]).*sin(2.*\[Phi])+ ...
  2.*d\[Theta]dx.*d\[Theta]dy.*sin(2.*\[Theta]).*sin(2.*\[Phi])+2.*d\[Phi]dx.*d\[Phi]dy.*sin(2.*\[Theta]).*sin( ...
  2.*\[Phi]))+(1/4).*K22.*((-4).*d2\[Theta]dydy.*cos(\[Phi]).^2+4.*d\[Theta]dx.*d\[Phi]dy.*cos(\[Phi]) ...
  .^2+(-4).*d2\[Phi]dydz.*cos(\[Phi]).*sin(\[Theta]).^2+8.*d\[Phi]dz.^2.*cos(\[Theta]).*sin(\[Theta]) ...
  .^3+2.*d2\[Phi]dxdy.*cos(\[Phi]).^2.*sin(2.*\[Theta])+(-2).*d\[Phi]dx.^2.*cos(\[Phi]).^2.* ...
  sin(2.*\[Theta])+2.*d\[Phi]dy.^2.*cos(\[Phi]).^2.*sin(2.*\[Theta])+d\[Phi]dx.^2.*cos(\[Phi]).^2.* ...
  sin(4.*\[Theta])+4.*d2\[Phi]dxdz.*sin(\[Theta]).^2.*sin(\[Phi])+(-4).*d2\[Theta]dxdx.*sin(\[Phi]).^2+( ...
  -4).*d\[Theta]dx.*d\[Phi]dy.*sin(\[Phi]).^2+(-2).*d2\[Phi]dxdy.*sin(2.*\[Theta]).*sin(\[Phi]).^2+2.* ...
  d\[Phi]dx.^2.*sin(2.*\[Theta]).*sin(\[Phi]).^2+(-2).*d\[Phi]dy.^2.*sin(2.*\[Theta]).*sin(\[Phi]).^2+ ...
  d\[Phi]dy.^2.*sin(4.*\[Theta]).*sin(\[Phi]).^2+(-8).*d\[Phi]dz.*cos(2.*\[Theta]).*sin(\[Theta]).^2.*( ...
  d\[Phi]dx.*cos(\[Phi])+d\[Phi]dy.*sin(\[Phi]))+4.*d2\[Theta]dxdy.*sin(2.*\[Phi])+(-4).*d\[Theta]dx.* ...
  d\[Phi]dx.*sin(2.*\[Phi])+(-1).*d2\[Phi]dxdx.*sin(2.*\[Theta]).*sin(2.*\[Phi])+d2\[Phi]dydy.*sin( ...
  2.*\[Theta]).*sin(2.*\[Phi])+(-4).*d\[Phi]dx.*d\[Phi]dy.*sin(2.*\[Theta]).*sin(2.*\[Phi])+d\[Phi]dx.* ...
  d\[Phi]dy.*sin(4.*\[Theta]).*sin(2.*\[Phi])+4.*d\[Theta]dy.*(d\[Phi]dx.*cos(2.*\[Phi])+d\[Phi]dy.*sin(2.* ...
  \[Phi])))+K33.*((-1/2).*d2\[Theta]dzdz+(-1/2).*d2\[Theta]dzdz.*cos(2.*\[Theta])+(-1).*d\[Theta]dx.* ...
  d\[Theta]dz.*cos(2.*\[Theta]).*cos(\[Phi])+(-1).*d2\[Theta]dxdx.*cos(\[Phi]).^2.*sin(\[Theta]).^2+(-1).* ...
  d\[Theta]dy.*d\[Phi]dx.*cos(\[Phi]).^2.*sin(\[Theta]).^2+(-1).*d\[Theta]dx.*d\[Phi]dy.*cos(\[Phi]).^2.*sin( ...
  \[Theta]).^2+d\[Theta]dz.^2.*sin(2.*\[Theta])+(-1).*d2\[Theta]dxdz.*cos(\[Phi]).*sin(2.*\[Theta])+(-1/2).* ...
  d\[Theta]dy.*d\[Phi]dz.*cos(\[Phi]).*sin(2.*\[Theta])+(-1).*d\[Theta]dx.^2.*cos(\[Phi]).^2.*sin(2.*\[Theta])+ ...
  (-1).*d\[Theta]dy.*d\[Theta]dz.*cos(2.*\[Theta]).*sin(\[Phi])+(-1).*d2\[Theta]dydz.*sin(2.*\[Theta]).*sin( ...
  \[Phi])+(1/2).*d\[Theta]dx.*d\[Phi]dz.*sin(2.*\[Theta]).*sin(\[Phi])+(-1).*d2\[Theta]dydy.*sin(\[Theta]).^2.* ...
  sin(\[Phi]).^2+d\[Theta]dy.*d\[Phi]dx.*sin(\[Theta]).^2.*sin(\[Phi]).^2+d\[Theta]dx.*d\[Phi]dy.*sin(\[Theta]).^2.* ...
  sin(\[Phi]).^2+(-1).*d\[Theta]dy.^2.*sin(2.*\[Theta]).*sin(\[Phi]).^2+(-1/2).*d\[Theta]dz.*( ...
  d\[Phi]dy.*cos(\[Phi]).*sin(2.*\[Theta])+2.*d\[Theta]dy.*cos(2.*\[Theta]).*sin(\[Phi]))+(-1/2).*d\[Theta]dz.* ...
  (2.*d\[Theta]dx.*cos(2.*\[Theta]).*cos(\[Phi])+(-1).*d\[Phi]dx.*sin(2.*\[Theta]).*sin(\[Phi]))+(-1).* ...
  d2\[Theta]dxdy.*sin(\[Theta]).^2.*sin(2.*\[Phi])+d\[Theta]dx.*d\[Phi]dx.*sin(\[Theta]).^2.*sin(2.*\[Phi])+( ...
  -1).*d\[Theta]dy.*d\[Phi]dy.*sin(\[Theta]).^2.*sin(2.*\[Phi])+(-1).*d\[Theta]dx.*d\[Theta]dy.*sin(2.*\[Theta]) ...
  .*sin(2.*\[Phi])+(1/32).*(32.*sin(\[Theta]).^2.*((-1).*d\[Theta]dz.*sin(\[Theta])+cos(\[Theta]).*( ...
  d\[Theta]dx.*cos(\[Phi])+d\[Theta]dy.*sin(\[Phi]))).*(d\[Theta]dz.*cos(\[Theta])+sin(\[Theta]).*(d\[Theta]dx.*cos(\[Phi])+ ...
  d\[Theta]dy.*sin(\[Phi])))+32.*cos(\[Theta]).*sin(\[Theta]).*(d\[Theta]dz.*cos(\[Theta])+sin(\[Theta]).*(d\[Theta]dx.* ...
  cos(\[Phi])+d\[Theta]dy.*sin(\[Phi]))).^2+(-4).*(4.*d\[Theta]dz.*cos(\[Theta]).^2.*cos(\[Phi])+2.* ...
  d\[Theta]dx.*sin(2.*\[Theta])+(-2).*d\[Phi]dz.*sin(2.*\[Theta]).*sin(\[Phi])+(-4).*d\[Phi]dy.*sin(\[Theta]) ...
  .^2.*sin(\[Phi]).^2+(-2).*d\[Theta]dx.*sin(2.*\[Theta]).*sin(\[Phi]).^2+(-2).*d\[Phi]dx.*sin(\[Theta]) ...
  .^2.*sin(2.*\[Phi])+d\[Theta]dy.*sin(2.*\[Theta]).*sin(2.*\[Phi])).*((-2).*d\[Theta]dx.*cos(2.*\[Theta]) ...
  +2.*d\[Theta]dz.*cos(\[Phi]).*sin(2.*\[Theta])+2.*d\[Phi]dz.*cos(2.*\[Theta]).*sin(\[Phi])+2.*d\[Theta]dx.* ...
  cos(2.*\[Theta]).*sin(\[Phi]).^2+2.*d\[Phi]dy.*sin(2.*\[Theta]).*sin(\[Phi]).^2+(-1).*d\[Theta]dy.* ...
  cos(2.*\[Theta]).*sin(2.*\[Phi])+d\[Phi]dx.*sin(2.*\[Theta]).*sin(2.*\[Phi]))+2.*(4.*d\[Phi]dx.*cos( ...
  \[Phi]).^2.*sin(\[Theta]).^2+2.*d\[Theta]dy.*sin(2.*\[Theta])+2.*d\[Phi]dz.*cos(\[Phi]).*sin(2.*\[Theta])+( ...
  -2).*d\[Theta]dy.*cos(\[Phi]).^2.*sin(2.*\[Theta])+4.*d\[Theta]dz.*cos(\[Theta]).^2.*sin(\[Phi])+2.* ...
  d\[Phi]dy.*sin(\[Theta]).^2.*sin(2.*\[Phi])+d\[Theta]dx.*sin(2.*\[Theta]).*sin(2.*\[Phi])).*(4.*d\[Theta]dy.* ...
  cos(2.*\[Theta])+4.*d\[Phi]dz.*cos(2.*\[Theta]).*cos(\[Phi])+(-4).*d\[Theta]dy.*cos(2.*\[Theta]).*cos(\[Phi]) ...
  .^2+4.*d\[Phi]dx.*cos(\[Phi]).^2.*sin(2.*\[Theta])+(-4).*d\[Theta]dz.*sin(2.*\[Theta]).*sin(\[Phi])+ ...
  2.*d\[Theta]dx.*cos(2.*\[Theta]).*sin(2.*\[Phi])+2.*d\[Phi]dy.*sin(2.*\[Theta]).*sin(2.*\[Phi]))));


ELy = (1/8).*K22.*((-4).*d\[Theta]dx.*d\[Theta]dy.*cos(2.*\[Theta])+(-8).*d\[Theta]dx.*d\[Theta]dy.*cos(\[Phi]) ...
  .^2+8.*d\[Theta]dx.*d\[Theta]dy.*cos(2.*\[Theta]).*cos(\[Phi]).^2+4.*d\[Theta]dx.*d\[Theta]dy.*cos(2.*\[Theta]).* ...
  cos(2.*\[Phi])+(-8).*d2\[Theta]dydz.*cos(\[Phi]).*sin(\[Theta]).^2+8.*d\[Theta]dx.*d\[Phi]dz.*cos(\[Phi]).* ...
  sin(\[Theta]).^2+16.*d\[Theta]dx.*d\[Phi]dz.*cos(2.*\[Theta]).*cos(\[Phi]).*sin(\[Theta]).^2+16.* ...
  d2\[Phi]dxdz.*cos(\[Theta]).*cos(\[Phi]).*sin(\[Theta]).^3+8.*d\[Phi]dy.*d\[Phi]dz.*cos(\[Theta]).*cos(\[Phi]).* ...
  sin(\[Theta]).^3+(-8).*d2\[Phi]dzdz.*sin(\[Theta]).^4+4.*d2\[Theta]dxdy.*cos(\[Phi]).^2.*sin(2.* ...
  \[Theta])+(-2).*d2\[Phi]dxdx.*cos(\[Phi]).^2.*sin(2.*\[Theta]).^2+(-2).*d\[Phi]dx.*d\[Phi]dy.*cos(\[Phi]) ...
  .^2.*sin(2.*\[Theta]).^2+(-4).*d\[Theta]dx.*d\[Phi]dx.*cos(\[Phi]).^2.*sin(4.*\[Theta])+8.* ...
  d2\[Theta]dxdz.*sin(\[Theta]).^2.*sin(\[Phi])+8.*d\[Theta]dy.*d\[Phi]dz.*sin(\[Theta]).^2.*sin(\[Phi])+16.* ...
  d\[Theta]dy.*d\[Phi]dz.*cos(2.*\[Theta]).*sin(\[Theta]).^2.*sin(\[Phi])+16.*d2\[Phi]dydz.*cos(\[Theta]).*sin( ...
  \[Theta]).^3.*sin(\[Phi])+(-8).*d\[Phi]dx.*d\[Phi]dz.*cos(\[Theta]).*sin(\[Theta]).^3.*sin(\[Phi])+8.* ...
  d\[Theta]dx.*d\[Theta]dy.*sin(\[Phi]).^2+(-4).*d2\[Theta]dxdy.*sin(2.*\[Theta]).*sin(\[Phi]).^2+(-2).* ...
  d2\[Phi]dydy.*sin(2.*\[Theta]).^2.*sin(\[Phi]).^2+2.*d\[Phi]dx.*d\[Phi]dy.*sin(2.*\[Theta]).^2.*sin( ...
  \[Phi]).^2+(-4).*d\[Theta]dy.*d\[Phi]dy.*sin(4.*\[Theta]).*sin(\[Phi]).^2+(-2).*d\[Theta]dz.*(16.* ...
  d\[Phi]dz.*cos(\[Theta]).*sin(\[Theta]).^3+(-2).*(2.*d\[Phi]dx.*cos(2.*\[Theta]).*cos(\[Phi]).*sin(\[Theta]) ...
  .^2+(-2).*d\[Theta]dy.*cos(\[Phi]).*sin(2.*\[Theta])+d\[Phi]dx.*cos(\[Phi]).*sin(2.*\[Theta]).^2+2.* ...
  d\[Phi]dy.*(1+2.*cos(2.*\[Theta])).*sin(\[Theta]).^2.*sin(\[Phi])+2.*d\[Theta]dx.*sin(2.*\[Theta]).*sin( ...
  \[Phi])))+4.*d\[Theta]dx.^2.*sin(2.*\[Phi])+(-4).*d\[Theta]dy.^2.*sin(2.*\[Phi])+(-4).* ...
  d\[Theta]dx.^2.*cos(2.*\[Theta]).*sin(2.*\[Phi])+4.*d\[Theta]dy.^2.*cos(2.*\[Theta]).*sin(2.*\[Phi])+( ...
  -2).*d2\[Theta]dxdx.*sin(2.*\[Theta]).*sin(2.*\[Phi])+2.*d2\[Theta]dydy.*sin(2.*\[Theta]).*sin(2.* ...
  \[Phi])+(-2).*d2\[Phi]dxdy.*sin(2.*\[Theta]).^2.*sin(2.*\[Phi])+d\[Phi]dx.^2.*sin(2.*\[Theta]).^2.* ...
  sin(2.*\[Phi])+(-1).*d\[Phi]dy.^2.*sin(2.*\[Theta]).^2.*sin(2.*\[Phi])+(-2).*d\[Theta]dy.* ...
  d\[Phi]dx.*sin(4.*\[Theta]).*sin(2.*\[Phi])+(-2).*d\[Theta]dx.*d\[Phi]dy.*sin(4.*\[Theta]).*sin(2.*\[Phi])) ...
  +(-1/2).*K11.*sin(\[Theta]).*(2.*d\[Theta]dx.*d\[Phi]dx.*cos(\[Theta])+2.*d2\[Theta]dxdy.*cos(\[Theta]).* ...
  cos(\[Phi]).^2+(-2).*d\[Theta]dx.*d\[Phi]dx.*cos(\[Theta]).*cos(\[Phi]).^2+d2\[Phi]dxdx.*sin(\[Theta])+ ...
  d2\[Phi]dydy.*sin(\[Theta])+(-2).*d2\[Theta]dydz.*cos(\[Phi]).*sin(\[Theta])+(-1).*d2\[Phi]dxdx.*cos( ...
  \[Phi]).^2.*sin(\[Theta])+d2\[Phi]dydy.*cos(\[Phi]).^2.*sin(\[Theta])+(-2).*d\[Phi]dx.*d\[Phi]dy.*cos(\[Phi]) ...
  .^2.*sin(\[Theta])+2.*d2\[Theta]dxdz.*sin(\[Theta]).*sin(\[Phi])+(-2).*d2\[Theta]dxdy.*cos(\[Theta]).*sin( ...
  \[Phi]).^2+2.*d\[Theta]dx.*d\[Phi]dx.*cos(\[Theta]).*sin(\[Phi]).^2+d2\[Phi]dxdx.*sin(\[Theta]).*sin(\[Phi]).^2+ ...
  (-1).*d2\[Phi]dydy.*sin(\[Theta]).*sin(\[Phi]).^2+2.*d\[Phi]dx.*d\[Phi]dy.*sin(\[Theta]).*sin(\[Phi]).^2+ ...
  (-2).*d\[Theta]dz.*cos(\[Theta]).*(d\[Theta]dy.*cos(\[Phi])+(-1).*d\[Theta]dx.*sin(\[Phi]))+(-1).* ...
  d2\[Theta]dxdx.*cos(\[Theta]).*sin(2.*\[Phi])+d2\[Theta]dydy.*cos(\[Theta]).*sin(2.*\[Phi])+(-2).*d\[Theta]dx.* ...
  d\[Phi]dy.*cos(\[Theta]).*sin(2.*\[Phi])+(-2).*d2\[Phi]dxdy.*sin(\[Theta]).*sin(2.*\[Phi])+d\[Theta]dx.^2.* ...
  sin(\[Theta]).*sin(2.*\[Phi])+(-1).*d\[Theta]dy.^2.*sin(\[Theta]).*sin(2.*\[Phi])+d\[Phi]dx.^2.*sin(\[Theta]) ...
  .*sin(2.*\[Phi])+(-1).*d\[Phi]dy.^2.*sin(\[Theta]).*sin(2.*\[Phi])+d\[Theta]dy.*(4.*d\[Phi]dy.*cos( ...
  \[Theta]).*cos(\[Phi]).^2+(-2).*d\[Theta]dx.*cos(2.*\[Phi]).*sin(\[Theta])+(-2).*d\[Phi]dx.*cos(\[Theta]).* ...
  sin(2.*\[Phi])))+K33.*((-1/2).*d2\[Phi]dzdz.*sin(\[Theta]).^2+(-1/2).*d2\[Phi]dzdz.*cos( ...
  2.*\[Theta]).*sin(\[Theta]).^2+(-2).*d\[Theta]dz.*d\[Phi]dx.*cos(\[Theta]).^2.*cos(\[Phi]).*sin(\[Theta]).^2+( ...
  -2).*d2\[Phi]dxdz.*cos(\[Theta]).*cos(\[Phi]).*sin(\[Theta]).^3+(-1).*d\[Phi]dy.*d\[Phi]dz.*cos(\[Theta]).* ...
  cos(\[Phi]).*sin(\[Theta]).^3+(-4).*d\[Theta]dx.*d\[Phi]dx.*cos(\[Theta]).*cos(\[Phi]).^2.*sin(\[Theta]).^3+( ...
  -1).*d2\[Phi]dxdx.*cos(\[Phi]).^2.*sin(\[Theta]).^4+(-2).*d\[Phi]dx.*d\[Phi]dy.*cos(\[Phi]).^2.* ...
  sin(\[Theta]).^4+(-1/2).*d\[Theta]dz.*d\[Phi]dz.*sin(2.*\[Theta])+(-1/4).*d\[Theta]dz.*d\[Phi]dz.*sin( ...
  4.*\[Theta])+(-2).*d2\[Phi]dydz.*cos(\[Theta]).*sin(\[Theta]).^3.*sin(\[Phi])+d\[Phi]dx.*d\[Phi]dz.*cos(\[Theta]) ...
  .*sin(\[Theta]).^3.*sin(\[Phi])+(-1/2).*d\[Theta]dz.*d\[Phi]dy.*sin(2.*\[Theta]).^2.*sin(\[Phi])+(-1) ...
  .*d2\[Phi]dydy.*sin(\[Theta]).^4.*sin(\[Phi]).^2+2.*d\[Phi]dx.*d\[Phi]dy.*sin(\[Theta]).^4.*sin(\[Phi]) ...
  .^2+(-1).*d\[Theta]dy.*d\[Phi]dy.*sin(2.*\[Theta]).*sin(\[Phi]).^2+(1/2).*d\[Theta]dy.*d\[Phi]dy.*sin( ...
  4.*\[Theta]).*sin(\[Phi]).^2+(-1).*d\[Phi]dz.*sin(\[Theta]).^2.*(d\[Phi]dy.*cos(\[Theta]).*cos(\[Phi]).* ...
  sin(\[Theta])+d\[Theta]dy.*(1+2.*cos(2.*\[Theta])).*sin(\[Phi]))+(1/2).*d\[Phi]dz.*sin(\[Theta]).^2.*(( ...
  -2).*d\[Theta]dx.*(1+2.*cos(2.*\[Theta])).*cos(\[Phi])+d\[Phi]dx.*sin(2.*\[Theta]).*sin(\[Phi]))+ ...
  d\[Theta]dz.*sin(\[Theta]).^2.*(d\[Phi]dz.*sin(2.*\[Theta])+(-1).*cos(2.*\[Theta]).*(d\[Phi]dx.*cos(\[Phi])+ ...
  d\[Phi]dy.*sin(\[Phi])))+(-2).*d\[Theta]dx.*d\[Phi]dy.*cos(\[Theta]).*sin(\[Theta]).^3.*sin(2.*\[Phi])+(-1) ...
  .*d2\[Phi]dxdy.*sin(\[Theta]).^4.*sin(2.*\[Phi])+d\[Phi]dx.^2.*sin(\[Theta]).^4.*sin(2.*\[Phi])+(-1) ...
  .*d\[Phi]dy.^2.*sin(\[Theta]).^4.*sin(2.*\[Phi])+(-1/2).*d\[Theta]dy.*d\[Phi]dx.*sin(2.*\[Theta]).* ...
  sin(2.*\[Phi])+(1/4).*d\[Theta]dy.*d\[Phi]dx.*sin(4.*\[Theta]).*sin(2.*\[Phi])+(1/32).*(32.* ...
  sin(\[Theta]).^3.*(d\[Theta]dy.*cos(\[Phi])+(-1).*d\[Theta]dx.*sin(\[Phi])).*(d\[Theta]dz.*cos(\[Theta])+sin(\[Theta]) ...
  .*(d\[Theta]dx.*cos(\[Phi])+d\[Theta]dy.*sin(\[Phi])))+4.*(4.*d\[Phi]dx.*cos(\[Phi]).^2.*sin(\[Theta]).^2+ ...
  2.*d\[Theta]dy.*sin(2.*\[Theta])+2.*d\[Phi]dz.*cos(\[Phi]).*sin(2.*\[Theta])+(-2).*d\[Theta]dy.*cos(\[Phi]) ...
  .^2.*sin(2.*\[Theta])+4.*d\[Theta]dz.*cos(\[Theta]).^2.*sin(\[Phi])+2.*d\[Phi]dy.*sin(\[Theta]).^2.*sin( ...
  2.*\[Phi])+d\[Theta]dx.*sin(2.*\[Theta]).*sin(2.*\[Phi])).*(2.*d\[Theta]dz.*cos(\[Theta]).^2.*cos(\[Phi])+2.* ...
  d\[Phi]dy.*cos(2.*\[Phi]).*sin(\[Theta]).^2+d\[Theta]dx.*cos(2.*\[Phi]).*sin(2.*\[Theta])+(-1).*d\[Phi]dz.* ...
  sin(2.*\[Theta]).*sin(\[Phi])+(-2).*d\[Phi]dx.*sin(\[Theta]).^2.*sin(2.*\[Phi])+d\[Theta]dy.*sin(2.*\[Theta]) ...
  .*sin(2.*\[Phi]))+(-4).*(2.*d\[Phi]dx.*cos(2.*\[Phi]).*sin(\[Theta]).^2+d\[Phi]dz.*cos(\[Phi]).* ...
  sin(2.*\[Theta])+(-1).*d\[Theta]dy.*cos(2.*\[Phi]).*sin(2.*\[Theta])+2.*d\[Theta]dz.*cos(\[Theta]).^2.* ...
  sin(\[Phi])+2.*d\[Phi]dy.*sin(\[Theta]).^2.*sin(2.*\[Phi])+d\[Theta]dx.*sin(2.*\[Theta]).*sin(2.*\[Phi])).* ...
  (4.*d\[Theta]dz.*cos(\[Theta]).^2.*cos(\[Phi])+2.*d\[Theta]dx.*sin(2.*\[Theta])+(-2).*d\[Phi]dz.*sin(2.* ...
  \[Theta]).*sin(\[Phi])+(-4).*d\[Phi]dy.*sin(\[Theta]).^2.*sin(\[Phi]).^2+(-2).*d\[Theta]dx.*sin(2.*\[Theta]) ...
  .*sin(\[Phi]).^2+(-2).*d\[Phi]dx.*sin(\[Theta]).^2.*sin(2.*\[Phi])+d\[Theta]dy.*sin(2.*\[Theta]).*sin( ...
  2.*\[Phi]))));


%}


return
end

